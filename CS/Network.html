<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Network</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Network"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2014-03-21T14:53+0800"/>
<meta name="author" content="ChrisChen"/>
<meta name="description" content=""/>
<meta name="keywords" content="Network"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="../css/stylesheet.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js">
/**
 *
 * @source: http://cdn.mathjax.org/mathjax/latest/MathJax.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in http://cdn.mathjax.org/mathjax/latest/MathJax.js.
 *
 * Copyright (C) 2012-2013  MathJax
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in http://cdn.mathjax.org/mathjax/latest/MathJax.js.
 *
 */

/*
@licstart  The following is the entire license notice for the
JavaScript code below.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code below is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code below.
*/
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "left",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:100%;white-space:nowrap;">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div>


<div id="content">
<h1 class="title">Network</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Physical Layer</a>
<ul>
<li><a href="#sec-1-1">1.1 Latency</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1 Bandwidth-Delay</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2 Media</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1 Wires</a></li>
<li><a href="#sec-1-2-2">1.2.2 Fiber</a></li>
<li><a href="#sec-1-2-3">1.2.3 Wireless</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3 Signal</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1 Frequency Representation</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4 Modulation</a></li>
<li><a href="#sec-1-5">1.5 Limit</a>
<ul>
<li><a href="#sec-1-5-1">1.5.1 Nyquist Limit</a></li>
<li><a href="#sec-1-5-2">1.5.2 Shannon Capacity</a></li>
</ul>
</li>
<li><a href="#sec-1-6">1.6 Other Hints</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1 Metric Units</a></li>
<li><a href="#sec-1-6-2">1.6.2 BandWidth</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-2">2 Data Link Layer</a>
<ul>
<li><a href="#sec-2-1">2.1 Frame</a>
<ul>
<li><a href="#sec-2-1-1">2.1.1 Bit Stuffing</a></li>
<li><a href="#sec-2-1-2">2.1.2 Example(PPP)</a></li>
</ul>
</li>
<li><a href="#sec-2-2">2.2 Error Detection</a>
<ul>
<li><a href="#sec-2-2-1">2.2.1 Keywords</a></li>
<li><a href="#sec-2-2-2">2.2.2 Parity</a></li>
<li><a href="#sec-2-2-3">2.2.3 Checksums</a></li>
<li><a href="#sec-2-2-4">2.2.4 CRC(Cyclic Redundancy Check)</a></li>
<li><a href="#sec-2-2-5">2.2.5 In Practice</a></li>
</ul>
</li>
<li><a href="#sec-2-3">2.3 Error Correction</a>
<ul>
<li><a href="#sec-2-3-1">2.3.1 Hamming Code</a></li>
</ul>
</li>
<li><a href="#sec-2-4">2.4 Detection vs. Correction</a></li>
<li><a href="#sec-2-5">2.5 ARP(Address Resolution Protocol)</a></li>
</ul>
</li>
<li><a href="#sec-3">3 Medium Access Control Sublayer</a>
<ul>
<li><a href="#sec-3-1">3.1 Retransmissions</a>
<ul>
<li><a href="#sec-3-1-1">3.1.1 Timeouts</a></li>
<li><a href="#sec-3-1-2">3.1.2 Duplicates</a></li>
</ul>
</li>
<li><a href="#sec-3-2">3.2 Multiplexing</a>
<ul>
<li><a href="#sec-3-2-1">3.2.1 TDM/FDM Usage</a></li>
</ul>
</li>
<li><a href="#sec-3-3">3.3 Multiple Access Control</a>
<ul>
<li><a href="#sec-3-3-1">3.3.1 Randomized Multiple Access</a></li>
<li><a href="#sec-3-3-2">3.3.2 Wireless Multiple Access</a></li>
<li><a href="#sec-3-3-3">3.3.3 Turn-Taking Multiple Access</a></li>
</ul>
</li>
<li><a href="#sec-3-4">3.4 Switching</a>
<ul>
<li><a href="#sec-3-4-1">3.4.1 Switch Forwarding</a></li>
<li><a href="#sec-3-4-2">3.4.2 Switch Spanning Tree</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-4">4 Network Layer</a>
<ul>
<li><a href="#sec-4-1">4.1 Service Models</a>
<ul>
<li><a href="#sec-4-1-1">4.1.1 Store-and-Forward</a></li>
<li><a href="#sec-4-1-2">4.1.2 Datagrams(Connectionless)</a></li>
<li><a href="#sec-4-1-3">4.1.3 Virtual Circuits(Connection-Oriented)</a></li>
<li><a href="#sec-4-1-4">4.1.4 Datagrams vs Virtual Circuits</a></li>
</ul>
</li>
<li><a href="#sec-4-2">4.2 IP(Internet Protocol)</a>
<ul>
<li><a href="#sec-4-2-1">4.2.1 Internetworking</a></li>
<li><a href="#sec-4-2-2">4.2.2 IPv4</a></li>
<li><a href="#sec-4-2-3">4.2.3 IP Forwarding</a></li>
<li><a href="#sec-4-2-4">4.2.4 Packet Size Issue</a></li>
<li><a href="#sec-4-2-5">4.2.5 ICMP(Internet Control Message Protocol)</a></li>
<li><a href="#sec-4-2-6">4.2.6 IPv6</a></li>
</ul>
</li>
<li><a href="#sec-4-3">4.3 Traceroute</a></li>
<li><a href="#sec-4-4">4.4 NAT(Network Address Translation)</a></li>
</ul>
</li>
<li><a href="#sec-5">5 Application Layer</a>
<ul>
<li><a href="#sec-5-1">5.1 DHCP(Dynamic Host Configuration Protocol)</a>
<ul>
<li><a href="#sec-5-1-1">5.1.1 How does node find DHCP server?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Physical Layer</h2>
<div class="outline-text-2" id="text-1">

<p>Concerns how signals are used to transfer message bits over a link.
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Latency</h3>
<div class="outline-text-3" id="text-1-1">

<p>Message Latency is the delay to send a message over a link.
</p><ul>
<li>Transmission Delay
  Time to put M-bit message "on the wire"
  $$T-delay = \frac{M(bits)}{Rate(bits/sec)} = \frac{M}{R}\ seconds$$
</li>
<li>Propagation Delay
  Time for bits to propagate across the wire
  $$P-delay = \frac{Length}{speed\ of\ signals} \approx \frac{Length}{\frac{2}{3}C} = D\ seconds$$
  C is the speed of light.

<p class="verse">
In wireless communication, s=c, i.e. the speed of light. <br/>
In copper wire, the speed s generally ranges from .59c to .77c<br/>
</p>


</li>
</ul>



<p>
so $$L = \frac{M}{R} + D$$
Often one delay component dominates.
</p>
</div>

<div id="outline-container-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> Bandwidth-Delay</h4>
<div class="outline-text-4" id="text-1-1-1">

<p>BD is the amount of data in flight. Reperesents the data "in the network".
$$BD = R\times D$$
Small for LANs, big for "long fat" pipes.
</p></div>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Media</h3>
<div class="outline-text-3" id="text-1-2">

<p>Media propagate signals that carry bits of information
</p>
</div>

<div id="outline-container-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Wires</h4>
<div class="outline-text-4" id="text-1-2-1">

<ul>
<li>Twisted Pair

<p class="verse">
Widely used in LANs and telephone lines<br/>
Twist reduce radiated signal.<br/>
</p>


</li>
<li>Coaxial Cable
</li>
</ul>

</div>

</div>

<div id="outline-container-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Fiber</h4>
<div class="outline-text-4" id="text-1-2-2">

<p>Long, thin, pure strands of glass. Properties:
</p><ul>
<li>Enormous bandwidth
</li>
</ul>

</div>

</div>

<div id="outline-container-1-2-3" class="outline-4">
<h4 id="sec-1-2-3"><span class="section-number-4">1.2.3</span> Wireless</h4>
<div class="outline-text-4" id="text-1-2-3">

<p>Sender radiates signal over a region. Properties:
</p><ul>
<li>In many directions, to potentially many receivers.
</li>
<li>Receiver need to coordinate use(choose a sender).
</li>
</ul>

</div>
</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Signal</h3>
<div class="outline-text-3" id="text-1-3">

<p>Analog signals encode digital bits.
</p>
</div>

<div id="outline-container-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Frequency Representation</h4>
<div class="outline-text-4" id="text-1-3-1">

<p>A signal over time can be represented by its frequency components.(Fourier analysis)
$$g(t)=\frac{1}{2}c+\sum_{n=1}^\infty a_n sin(2\pi nft) + \sum b_n cos(2\pi nft)$$
</p></div>
</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Modulation</h3>
<div class="outline-text-3" id="text-1-4">

<ul>
<li>NRZ(Non-Return to Zero)
  Let a high voltage(+V) represent a 1, and low voltage(-V)represent a 0.
</li>
<li>Passband

<p class="verse">
Carriers is simply a signal oscillatiog at a desired frequency.<br/>
To modulate these signal, we can change amplitude, frequency, or phase.<br/>
</p>



<div class="figure">
<p><img src="../resources/network/SignalModulation.png" align="center" alt="../resources/network/SignalModulation.png" /></p>
<p>Modulations</p>
</div>

</li>
<li>more signal levels
  eg: voltage splits into four levels. reperents 2bits per symbol.
</li>
<li>Clock Recovery
  Clock recovery is designed for the case like 1000000000&hellip;0
<ul>
<li>4B/5B

<p class="verse">
The baseband for wires.<br/>
Map every 4 bits into 5bits without long runs of zeros/ones.(called NRZI)<br/>
eg: 0000-&gt;11110, 0001-&gt;01001, 1110-&gt;11100, 1111-&gt;11101<br/>
Not work for fiber/wireless.Need to send at higher frequencies.<br/>
</p>


</li>
</ul>

</li>
</ul>


</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Limit</h3>
<div class="outline-text-3" id="text-1-5">


</div>

<div id="outline-container-1-5-1" class="outline-4">
<h4 id="sec-1-5-1"><span class="section-number-4">1.5.1</span> Nyquist Limit</h4>
<div class="outline-text-4" id="text-1-5-1">


$$Maximum\ data\ rate = 2Hlog_{2}V\ bits/sec$$

<p class="verse">
V is the discrete levels the signal consists.<br/>
H is the bandwidth<br/>
</p>


</div>

</div>

<div id="outline-container-1-5-2" class="outline-4">
<h4 id="sec-1-5-2"><span class="section-number-4">1.5.2</span> Shannon Capacity</h4>
<div class="outline-text-4" id="text-1-5-2">


$$Maximum\ data\ rate = Hlog_{2}(1+S/N)\ bits/sec$$

<p class="verse">
S/N is the signal-to-noise ratio, S is the signal power, N is the noise power.<br/>
S/N in db unit \(=10log_{10}(S/N)\)<br/>
</p>


</div>
</div>

</div>

<div id="outline-container-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Other Hints</h3>
<div class="outline-text-3" id="text-1-6">


</div>

<div id="outline-container-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Metric Units</h4>
<div class="outline-text-4" id="text-1-6-1">


<p class="verse">
Use power of 10 for rates, 2 for storage. <br/>
\(Mbps=1,000,000bps, 1KB = 2^{10}bytes\)
"B" is for bytes, "b" is for bits<br/>
</p>


</div>

</div>

<div id="outline-container-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> BandWidth</h4>
<div class="outline-text-4" id="text-1-6-2">

<p>The range of frequencies transmitted without being strongly attenuated is called the bandwidth
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Data Link Layer</h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Frame</h3>
<div class="outline-text-3" id="text-2-1">

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">FLAG</td><td class="left">Header</td><td class="left">Payload field</td><td class="left">Trailer</td><td class="left">FLAG</td></tr>
</tbody>
</table>


</div>

<div id="outline-container-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> Bit Stuffing</h4>
<div class="outline-text-4" id="text-2-1-1">

<p>After five 1s in the data, insert a 0.
</p></div>

</div>

<div id="outline-container-2-1-2" class="outline-4">
<h4 id="sec-2-1-2"><span class="section-number-4">2.1.2</span> Example(PPP)</h4>
<div class="outline-text-4" id="text-2-1-2">


<p class="verse">
PPP is a Point-to-Point Protocal.<br/>
FLAG in PPP is 0x7E, ESC is 0x7D.<br/>
To stuff(unstuff) a byte, add(remove) ESC(0x7D),<br/>
and XOR byte with 0x20.<br/>
</p>


</div>
</div>

</div>

<div id="outline-container-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Error Detection</h3>
<div class="outline-text-3" id="text-2-2">


</div>

<div id="outline-container-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> Keywords</h4>
<div class="outline-text-4" id="text-2-2-1">

<ul>
<li id="sec-2-2-1-1">Codeword<br/>
An n-bit unit containing data and check bits is often referred to as an n-bit codeword.
</li>
</ul>
<ul>
<li id="sec-2-2-1-2">Hamming distance<br/>
The number of bit positions in which two codewords differ is called the Hamming distance.

<ul>
<li>To detect <b>d</b> errors, we need <b>d+1</b> distance.
</li>
</ul>




<pre class="example">000, 111
001, 101 are both wrong.
</pre>


<ul>
<li>To correct <b>d</b> errors, we need <b>2d+1</b> distance. 
</li>
</ul>




<pre class="example">0000000000, 0000011111, 1111100000, 1111111111
Hamming distance: 5
Number of errors will be corrected: 2
When we get 0000000111,
If 2 errors occured, the rec
When we get 0000000111(2 errors occured), we can correct it: 0000011111
if three errors happen(0000000011), this code doesn't work.
</pre>


</li>
</ul>
</div>

</div>

<div id="outline-container-2-2-2" class="outline-4">
<h4 id="sec-2-2-2"><span class="section-number-4">2.2.2</span> Parity</h4>
<div class="outline-text-4" id="text-2-2-2">


<p class="verse">
Take D data bits, add 1 check bit.<br/>
Check bit is the sum of the D bits module 2.(diff by even sum or odd) <br/>
Distance: 2<br/>
Detect 1 error<br/>
</p>


</div>

</div>

<div id="outline-container-2-2-3" class="outline-4">
<h4 id="sec-2-2-3"><span class="section-number-4">2.2.3</span> Checksums</h4>
<div class="outline-text-4" id="text-2-2-3">

<ul>
<li>Sending
</li>
</ul>


<p>
Sum is defined in 1s complement.
</p><ol>
<li>Arrange data in 16-bit words
</li>
<li>Add all
</li>
<li>Add with the carryover back to get 16bits
</li>
<li>Trans to 1s Complement
</li>
</ol>





<pre class="example">0001+f203+f4f5+f6f7=2ddf0
ddf0+2=ddf2
ddf2-&gt;220d
</pre>


<ul>
<li>Receiving
</li>
</ul>



<ol>
<li>Arrange data in 16-bit words
</li>
<li>Add all + checksum
</li>
<li>Add any carryover back to get 16bits.
</li>
<li>Negate the result and check it is 0.
</li>
</ol>





<pre class="example">0001+f203+f4f5+f6f7+220d=2fffd
fffd+2 = ffff
ffff-&gt;0
</pre>


<ul>
<li>Conclusion
</li>
</ul>


<p class="verse">
Distance: 2<br/>
Detect 1 error<br/>
</p>


</div>

</div>

<div id="outline-container-2-2-4" class="outline-4">
<h4 id="sec-2-2-4"><span class="section-number-4">2.2.4</span> CRC(Cyclic Redundancy Check)</h4>
<div class="outline-text-4" id="text-2-2-4">


<p class="verse">
Given n data bits, generate k check bits such that the n+k bits are evenly <br/>
divisible by a generator C.<br/>
C(x) use the polynomial code:<br/>
eg: 10011010 is \(x^7+x^4+x^3+x^1\)<br/>
Both the high- and low-order bits of the generator must be 1<br/>
</p>


<ul>
<li>Sending
</li>
</ul>



<ol>
<li>Extend the n data bits with k zeros
</li>
<li>Divide by the generator value C
</li>
<li>Keep remainder, ignore quotient
</li>
<li>Adjust k check bits by remainder
</li>
</ol>




<pre class="example">Frame: 1101011011
Generator: 10011
K: 4 bits
11010111110000 devided by 10011
Reminder: 0010
</pre>



<p class="verse">
Note that: There are no carries for addition or borrows <br/>
for subtraction. Both addition and subtraction are <br/>
identical to exclusive OR.<br/>
</p>


<ul>
<li>Reveiving
</li>
</ul>



<ol>
<li>Divide and check for zero remainder
</li>
</ol>



<ul>
<li>Conclusion
</li>
</ul>


<p class="verse">
Protection depends on generator.<br/>
Standard CRC-32 is: 1 0000 0100 1100 0001 0001 1101 1011 0111<br/>
Distance: 4<br/>
Detect 3 errors<br/>
</p>


</div>

</div>

<div id="outline-container-2-2-5" class="outline-4">
<h4 id="sec-2-2-5"><span class="section-number-4">2.2.5</span> In Practice</h4>
<div class="outline-text-4" id="text-2-2-5">

<p>CRCs are widely used on links
</p><ul>
<li>Ethernet, 802.11, ADSL, Cable&hellip;
</li>
</ul>

<p>Checksum used in Internet
</p><ul>
<li>IP, TCP, UDP
</li>
</ul>

<p>Parity
</p><ul>
<li>Is little used
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Error Correction</h3>
<div class="outline-text-3" id="text-2-3">


</div>

<div id="outline-container-2-3-1" class="outline-4">
<h4 id="sec-2-3-1"><span class="section-number-4">2.3.1</span> Hamming Code</h4>
<div class="outline-text-4" id="text-2-3-1">


<p class="verse">
Uses \(n=2^k-k-1\)<br/>
n: data bits<br/>
k: check bits<br/>
eg: n=4, k=3<br/>
</p>


<ul>
<li>Put check bits in positions p that are powers of 2, starting with position 1
</li>
<li>Check bit in position p is parity of positions with a p term in their values
</li>
</ul>


<p>
<img src="../resources/network/HammingCodeModel.png" align="center" alt="../resources/network/HammingCodeModel.png" />
</p>
<ul>
<li>Encoding
</li>
</ul>




<pre class="example">data=0101, 3 check bits
__0_101
P1=0+1+1=0
P2=0+0+1=1
P4=1+0+1=0
After encoded: 0100101
</pre>


<ul>
<li>Decoding
</li>
</ul>




<pre class="example">0100101
P1=P1+D3+D5+D7=0+0+1+1=0
P2=P2+D3+D6+D7=1+0+0+1=0
P4=P4+D5+D6+D7=0+1+0+1=0
Syndrome=000, no error

0100111
P1=0, P2=1, P4=1
Syndrome=110-&gt;6
The 6th bit is wrong.
</pre>

</div>
</div>

</div>

<div id="outline-container-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Detection vs. Correction</h3>
<div class="outline-text-3" id="text-2-4">

<p>Error correction:
</p><ul>
<li>Needed when errors are expected
</li>
<li>When no time for retransmission
</li>
</ul>


<p>
Error dection:
</p><ul>
<li>More efficient when errors are not expected
</li>
<li>When errors are large when they do occur
</li>
</ul>

</div>

</div>

<div id="outline-container-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> ARP(Address Resolution Protocol)</h3>
<div class="outline-text-3" id="text-2-5">

<p>Node uses ARP to map a local IP address to its Link layer address
<img src="../resources/network/ARPPurpose.png" align="center" alt="../resources/network/ARPPurpose.png" />
</p>
<ul>
<li>No servers, just asks node with target IP.
</li>
<li>Uses <b>broadcast</b> to reach all nodes.
</li>
</ul>


<p>
<img src="../resources/network/ARPSeq.png" align="center" alt="../resources/network/ARPSeq.png" />
</p>
</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Medium Access Control Sublayer</h2>
<div class="outline-text-2" id="text-3">


</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Retransmissions</h3>
<div class="outline-text-3" id="text-3-1">

<p>Detect errors and retransmit frame(Automatic Repeat reQuest, ARQ)
</p><ul>
<li>ARQ often used when errors are common or must be corrected. E.g., WIFI, TCP
</li>
<li>Rules
</li>
</ul>


<p class="verse">
Receiver automatically confirms with an ACK.<br/>
Sender automatically resends after a timeout, until an ACK is received<br/>
</p>


<p>
Two non-trivial issues: <b>Timeouts</b> and <b>Duplicates</b>
</p>
</div>

<div id="outline-container-3-1-1" class="outline-4">
<h4 id="sec-3-1-1"><span class="section-number-4">3.1.1</span> Timeouts</h4>
<div class="outline-text-4" id="text-3-1-1">

<p>Should be 
</p><ul>
<li>Not too long (link goes idle)
</li>
<li>Not too short (spurious resend)
</li>
</ul>

</div>

</div>

<div id="outline-container-3-1-2" class="outline-4">
<h4 id="sec-3-1-2"><span class="section-number-4">3.1.2</span> Duplicates</h4>
<div class="outline-text-4" id="text-3-1-2">

<p>Two ways to solve this problem:
</p><ul>
<li id="sec-3-1-2-1">Stop-and-Wait<br/>
Add a single bit to distinguish the current frame from the next one(in the head of the frame)
<ul>
<li>Normal Case

<p>
  <img src="../resources/network/SaWNormalCase.png" align="center" alt="../resources/network/SaWNormalCase.png" />
</p></li>
<li>With Ack Loss

<p>
  <img src="../resources/network/SaWWithACKLoss.png" align="center" alt="../resources/network/SaWWithACKLoss.png" />
</p></li>
<li>With Early Timeout

<p>
  <img src="../resources/network/SaWWithEarlyTimeout.png" align="center" alt="../resources/network/SaWWithEarlyTimeout.png" />
</p>
</li>
<li>Limitation of Stop-and-Wait

<p class="verse">
Stop-and-Wait allows only one frame to <br/>
be outstanding from the sender at a time.<br/>
Not good with high BD networks.<br/>
</p>


</li>
</ul>

</li>
</ul>
<ul>
<li id="sec-3-1-2-2">Sliding Window<br/>
Generalization of Stop-and-Wait
<ul>
<li>Allow W frams to be outstanding
</li>
<li>Can send W frams per RTT (= 2D + transmission time, Round Trip Time)
</li>
<li>Various options for numbering frams/ACKs and handling loss
</li>
</ul>


</li>
</ul>
</div>
</div>

</div>

<div id="outline-container-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Multiplexing</h3>
<div class="outline-text-3" id="text-3-2">

<p><b>Multiplexing</b> is the network word for the sharing of a resource.
</p><ul>
<li>Time Division Multiplexing (TDM)

<p>
  Users take turns on a fixed schedule
</p>
</li>
<li>Frequency Division Multiplexing (FDM)

<p>
  Put different users on different frequency bands
</p></li>
</ul>


</div>

<div id="outline-container-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> TDM/FDM Usage</h4>
<div class="outline-text-4" id="text-3-2-1">

<ul>
<li>Statically divide a resource

<p class="verse">
Suited for continuous traffic, fixed <br/>
number of users<br/>
</p>


</li>
<li>Widely used in telecommunications

<p class="verse">
E.g:<br/>
TV and radio stations: FDM<br/>
GSM (2G cellular): TDM within FDM<br/>
</p>


</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Multiple Access Control</h3>
<div class="outline-text-3" id="text-3-3">


</div>

<div id="outline-container-3-3-1" class="outline-4">
<h4 id="sec-3-3-1"><span class="section-number-4">3.3.1</span> Randomized Multiple Access</h4>
<div class="outline-text-4" id="text-3-3-1">

<ul>
<li id="sec-3-3-1-1">ALOHA<br/>

<p class="verse">
Simple idea: <br/>
If there was a collision(no ACK received) then wait <br/>
a random time and resend.<br/>
</p>


<ul>
<li>Low load: Works well
</li>
<li>High load: Need improvement

<p>
  Improvement: divide time into slots(transmit frames at the beginnings of slots)
</p></li>
</ul>


</li>
</ul>
<ul>
<li id="sec-3-3-1-2">CSMA(Carrier Sense Multiple Access)<br/>

<ul>
<li><b>carrier sensing</b> (CSMA)


<p class="verse">
A node listens to the channel before transmitting.<br/>
</p>



</li>
<li><b>collision detection</b> (CSMA/CD)


<p class="verse">
A transmitting node listens to the channel while it is transmitting.<br/>
If it detects that another node is transmitting an interfering frame, <br/>
it stops transmitting and wait a random amount time before repeating.<br/>
</p>



<ul>
<li>Complications


<p class="verse">
Time window in which a node may hear of a collision is 2D seconds.<br/>
Solution: Impose a minimum frame size that last for 2D seconds.<br/>
Then, node can't finish before collision.<br/>
Note that: Ethernet minimum frame is 64bytes.<br/>
</p>



</li>
<li>Persistence


<p class="verse">
Multiple waiting nodes will queue up then collide. <br/>
Espacially on high load network.<br/>
<br/>
Idea to solve: N queued senders, each send probability 1/N. How to estimate?<br/>
<br/>
In practice: BEB(Binary Exponential Backoff)<br/>
Clever estimates the probability: <br/>
1st collision, wait 0 to 1 frame times; 2nd, 0 to 3; 3rd, 0 to 7;<br/>
BEB doubles interval for each successive collision.<br/>
</p>



</li>
<li>Summary

<ul>
<li>CSMA Improve ALOHA by listening for activity before sending.
</li>
<li>Can do easily with wire.
</li>
<li>Still possible to hear nothing when another node is sending because of delay.
</li>
<li>CSMA is a good defense against collisions only when BD is small
</li>
</ul>

</li>
</ul>

</li>
</ul>


</li>
</ul>
<ul>
<li id="sec-3-3-1-3">Classic Ethernet<br/>

<ul>
<li>10 Mbps over shared coaxial cable
</li>
<li>1-persistent CSMA/CD with BEB
</li>
<li>Frame Format
<ul>
<li>contains addresses of sender and receiver
</li>
<li>CRC-32 for error detection
</li>
<li>No ACKs or retransmission
</li>
<li>Start of frame identified with physical layer preamble

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">Preamble</td><td class="left">Dest addr</td><td class="left">Source addr</td><td class="left">Type</td><td class="left">Data(Packet from Network layer)</td><td class="left">Pad</td><td class="left">Check-sum</td></tr>
<tr><td class="left">8</td><td class="left">6</td><td class="left">6</td><td class="left">2</td><td class="left">0-1500</td><td class="left">0-46</td><td class="left">4</td></tr>
</tbody>
</table>

</li>
</ul>

</li>
</ul>
</div>

</div>

<div id="outline-container-3-3-2" class="outline-4">
<h4 id="sec-3-3-2"><span class="section-number-4">3.3.2</span> Wireless Multiple Access</h4>
<div class="outline-text-4" id="text-3-3-2">

<ul>
<li id="sec-3-3-2-1">Complications<br/>
Wireless can't work with CSMA/CD

<ul>
<li>Nodes may have different areas of coverage

<p>
  May case two problems:
</p>
<ul>
<li>Hidden Terminals

<p>
    A and C are hidden terminals when sending to B
    <img src="../resources/network/HiddenTerminal.png" align="center" alt="../resources/network/HiddenTerminal.png" />
</p>
</li>
<li>Exposed Terminals

<p>
    B and C are exposed terminals when sending to A and D
    <img src="../resources/network/ExposedTerminal.png" align="center" alt="../resources/network/ExposedTerminal.png" />
</p></li>
</ul>

</li>
</ul>



<ul>
<li>Nodes can't hear while sending

<p>  
  Detecting collisions wasted much time with wireless.
</p></li>
</ul>

</li>
</ul>
<ul>
<li id="sec-3-3-2-2">MACA Protocol<br/>
Uses a short handshake instead of CSMA

<ol>
<li>Sender transmits a RTS(Request-To-Send) with frame length
</li>
<li>Receiver replies with a CTS(Clear-To-Send) with frame length
</li>
<li>Sender transmits the frame while hearing the CTS <span style="text-decoration:underline;">stay silent</span>
</li>
</ol>



<ul>
<li>Solution For Hidden Terminals

<p>  
  <img src="../resources/network/MACAHiddenTerminal.png" align="center" alt="../resources/network/MACAHiddenTerminal.png" />
</p>
</li>
<li>Solution For Exposed Terminals

<p>  
  <img src="../resources/network/MACAExposedTerminal.png" align="center" alt="../resources/network/MACAExposedTerminal.png" />
</p>
</li>
<li>Collisions on the RTS/CTS are still possible, but less likely
</li>
</ul>

</li>
</ul>
<ul>
<li id="sec-3-3-2-3">802.11<br/>
<ul>
<li>Physical Layer
<ul>
<li>Uses 20/40Mhz, b/g/n on 2.4GHz, a/n on 5GHz
</li>
</ul>

</li>
<li>Link Layer
<ul>
<li>Multiple access uses CSMA/CA; RTS/CTS optional
    <img src="../resources/network/CSMACASeq.png" align="center" alt="../resources/network/CSMACASeq.png" />

<p>
    Backoff is a small random gap.
</p>
</li>
<li>Frames are ACKed and retransmitted with ARQ
</li>
<li>Three addresses(due to AP)
</li>
<li>Errors are detected with a 32-bit CRC
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">Frame control</td><td class="left">Duration</td><td class="left">Dest addr</td><td class="left">Source addr</td><td class="left">AP addr</td><td class="left">Data</td><td class="left">Check-sum</td></tr>
<tr><td class="left">2</td><td class="left">2</td><td class="left">6</td><td class="left">6</td><td class="left">6</td><td class="left">0-2312</td><td class="left">4</td></tr>
</tbody>
</table>

</li>
</ul>


</li>
</ul>
</div>

</div>

<div id="outline-container-3-3-3" class="outline-4">
<h4 id="sec-3-3-3"><span class="section-number-4">3.3.3</span> Turn-Taking Multiple Access</h4>
<div class="outline-text-4" id="text-3-3-3">

<p>Issue about CSMA under high load:
</p><ul>
<li>High overhead(expect collisions)
</li>
<li>Access time varies(random)
</li>
</ul>



<p class="verse">
Turn-Taking protocol defines an order in which nodes get a chance to send.<br/>
The way to define ordering:<br/>
E.g Token Ring, node addresses<br/>
</p>


<ul>
<li>Token Ring

<p>  
  Arrange nodes in a ring. Token rotates permission to send to each node in turn.
  <img src="../resources/network/TokenRing.png" align="center" alt="../resources/network/TokenRing.png" />
</p></li>
</ul>



<ul>
<li>Advantages:

<ol>
<li>Fixed overhead with no collisions
</li>
<li>Regular chance to send with no unlucky nodes

</li>
</ol>

</li>
<li>DisAdvantages(Complexity):

<ol>
<li>More things could be wrong. E.g: token lost
</li>
<li>High overhead at low load
</li>
</ol>

</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Switching</h3>
<div class="outline-text-3" id="text-3-4">


<p class="verse">
Hub/repeater for physical layer.<br/>
Router for network layer.<br/>
Switch for link layer.<br/>
</p>


<p>
Inside Switch Box:
</p>
<p>
<img src="../resources/network/InsideSwitch.png" align="center" alt="../resources/network/InsideSwitch.png" />
</p>

<p class="verse">
Uses buffers for multiple inputs to send to one output,<br/>
may overload, and lead to frame loss.<br/>
</p>


<p>
<img src="../resources/network/SwitchBuffer.png" align="center" alt="../resources/network/SwitchBuffer.png" />
</p>

</div>

<div id="outline-container-3-4-1" class="outline-4">
<h4 id="sec-3-4-1"><span class="section-number-4">3.4.1</span> Switch Forwarding</h4>
<div class="outline-text-4" id="text-3-4-1">

<p>Uses a learning table, sends to the port in the table or broadcasts to all ports.
</p>
</div>

</div>

<div id="outline-container-3-4-2" class="outline-4">
<h4 id="sec-3-4-2"><span class="section-number-4">3.4.2</span> Switch Spanning Tree</h4>
<div class="outline-text-4" id="text-3-4-2">

<ul>
<li>How can we connect switches in any topology?
</li>
<li>Problem - forwarding loops

<p>  
  <img src="../resources/network/RedundantLinks.png" align="center" alt="../resources/network/RedundantLinks.png" />
</p>
<p>
  Redundancy in case of failures. But loops occurs:
</p>
<ol>
<li>\(A\to C\to B, D-left, D-right\) 
</li>
<li>\(D-left\to C-right, E, F\) 
</li>
<li>\(D-right\to C-left, E, F\) 
</li>
<li>\(C-right\to D-left, A, B\) 
</li>
<li>\(C-left\to D-right, A, B\) 
</li>
<li>&hellip;
</li>
</ol>

</li>
</ul>


<ul>
<li id="sec-3-4-2-1">Solution<br/>

<p>
Switches collectively find a spanning tree for the topology
</p>
<p>
<img src="../resources/network/STSolution1.png" align="center" alt="../resources/network/STSolution1.png" />
</p>
<ul>
<li>Outline

<ol>
<li>Elect a root node of the tree(switch with the lowest addr)
</li>
<li>Grow tree as shortest distances from the root
</li>
<li>Turn off ports for forwarding if they aren't on the spanning tree
</li>
</ol>

</li>
</ul>



<ul>
<li>Algorithm

<ol>
<li>Each switch initially believes it is the root of the tree
</li>
<li>Each switch sends periodic updates to neighbors
</li>
<li>Switches favors ports with shorter distances to lowest root


<p class="verse">
Update Information like:<br/>
Hi, I'm <b>C</b>, the root is <b>A</b>, it's <b>2</b> hops away. (C, A, 2)<br/>
</p>


</li>
</ul>



<ul>
<li>Example:
<ul>
<li>At the beginning

<p>    
    <img src="../resources/network/STExample1.png" align="center" alt="../resources/network/STExample1.png" />
</p>
</li>
<li>1st round, sending:

<p>
    A sends (A,A,0) to say it is root. Same as B, C, D, E and F.
</p>
</li>
<li>1st round, receiving:

<p class="verse">
A still thinks (A,A,0)<br/>
B still thinks (B,B,0)<br/>
C updates to (C,A,1)<br/>
D updates to (D,C,1)<br/>
E updates to (E,A,1)<br/>
F updates to (F,B,1)<br/>
</p>


<p>
    <img src="../resources/network/STExample2.png" align="center" alt="../resources/network/STExample2.png" />
</p>
</li>
<li>2nd round, receiving:

<p class="verse">
A still thinks (A,A,0)<br/>
B updates to (B,A,2) via C<br/>
C remains (C,A,1)<br/>
D updates to (D,A,2) via C<br/>
E remains (E,A,1)<br/>
F remains (F,B,1)<br/>
</p>


<p>
    <img src="../resources/network/STExample3.png" align="center" alt="../resources/network/STExample3.png" />
</p>
</li>
<li>3rd round, receiving:

<p class="verse">
A remains (A,A,0)<br/>
B remains (B,A,2)<br/>
C remains (C,A,1)<br/>
D remains (D,A,2)<br/>
E remains (E,A,1)<br/>
F updates to (F,A,3) via B<br/>
</p>


<p>
    <img src="../resources/network/STExample4.png" align="center" alt="../resources/network/STExample4.png" />
</p>
</li>
<li>4th round

<p class="verse">
Steady-state has be reached<br/>
Turn off forwarding that is not on spanning tree<br/>
</p>



</li>
<li>Continus to run

<p class="verse">
Adapts by timeing out information<br/>
E.g: If A fails, other nodes forget it, and B will become the new root  <br/>
</p>


</li>
</ul>

</li>
</ul>

</li>
</ul>
</div>
</div>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Network Layer</h2>
<div class="outline-text-2" id="text-4">


</div>

<div id="outline-container-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Service Models</h3>
<div class="outline-text-3" id="text-4-1">


</div>

<div id="outline-container-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><span class="section-number-4">4.1.1</span> Store-and-Forward</h4>
<div class="outline-text-4" id="text-4-1-1">


<p class="verse">
Both of two models use Store-and-Forward packet switching.<br/>
Switching element has internal buffering for contention.<br/>
</p>


<ul>
<li>Buffer is typically a FIFO queue
</li>
<li>If full, packets will be discarded
</li>
</ul>

</div>

</div>

<div id="outline-container-4-1-2" class="outline-4">
<h4 id="sec-4-1-2"><span class="section-number-4">4.1.2</span> Datagrams(Connectionless)</h4>
<div class="outline-text-4" id="text-4-1-2">

<p>Like postal letters
</p><ul>
<li>Packets contain a dest. address
</li>
<li>Each router has a forwarding table(often changes) keyed by dest addr.
  Example table:
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>Router A's Table</caption>
<colgroup><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Dest.</th><th scope="col" class="left">Line</th></tr>
</thead>
<tbody>
<tr><td class="left">A</td><td class="left"></td></tr>
<tr><td class="left">B</td><td class="left">B</td></tr>
<tr><td class="left">C</td><td class="left">C</td></tr>
<tr><td class="left">D</td><td class="left">B</td></tr>
<tr><td class="left">E</td><td class="left">C</td></tr>
<tr><td class="left">F</td><td class="left">C</td></tr>
</tbody>
</table>

</li>
</ul>


</div>

</div>

<div id="outline-container-4-1-3" class="outline-4">
<h4 id="sec-4-1-3"><span class="section-number-4">4.1.3</span> Virtual Circuits(Connection-Oriented)</h4>
<div class="outline-text-4" id="text-4-1-3">

<p>Like a telephone call. Three steps:
</p><ol>
<li>Connection establishment, circuit is set up (Path is chosen, circuit info stored in routers)
</li>
<li>Data transfer, circuit is used
</li>
<li>Connection teardown, circuit is deleted
</li>
</ol>



<ul>
<li>Virtual means there's no bandwidth need be reserved
</li>
<li>Packets only contain a short label to identify the circuit
</li>
<li>Each router has a forwarding table keyed by circuit
  <img src="../resources/network/VirtualCircuitsTable.png" align="center" alt="../resources/network/VirtualCircuitsTable.png" />
</li>
</ul>



<ul>
<li id="sec-4-1-3-1">MPLS(Multi-Protocol Label Switching)<br/>
A virtual-circuit like technology widely used by ISPs.

<ul>
<li>ISP set up circuits inside their backbone ahead of time
</li>
<li>ISP add MPLS label to IP packet at ingress, undoes at egress

<p>
  <img src="../resources/network/MPLSStructure.png"  alt="../resources/network/MPLSStructure.png" />
</p></li>
</ul>


</li>
</ul>
</div>

</div>

<div id="outline-container-4-1-4" class="outline-4">
<h4 id="sec-4-1-4"><span class="section-number-4">4.1.4</span> Datagrams vs Virtual Circuits</h4>
<div class="outline-text-4" id="text-4-1-4">

<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="left">
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Issue</th><th scope="col" class="left">Datagrams</th><th scope="col" class="left">Vitual Circuits</th></tr>
</thead>
<tbody>
<tr><td class="left">Setup</td><td class="left">Not needed</td><td class="left">Required</td></tr>
<tr><td class="left">Router state</td><td class="left">Per destination</td><td class="left">Per connection</td></tr>
<tr><td class="left">Addresses</td><td class="left">Packet carries full addr</td><td class="left">Packet carries short label</td></tr>
<tr><td class="left">Routing</td><td class="left">Per packet</td><td class="left">Per circuit</td></tr>
<tr><td class="left">Failures</td><td class="left">Easier to mask</td><td class="left">Hard to mask</td></tr>
<tr><td class="left">Quality of service</td><td class="left">Diffcult to add</td><td class="left">Easier to add</td></tr>
</tbody>
</table>


</div>
</div>

</div>

<div id="outline-container-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> IP(Internet Protocol)</h3>
<div class="outline-text-3" id="text-4-2">


</div>

<div id="outline-container-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> Internetworking</h4>
<div class="outline-text-4" id="text-4-2-1">

<p>Connecting different networks together called internetworking. Differs:
</p><ul>
<li>Service model(datagrams, VCs)
</li>
<li>Addressing
</li>
<li>QOS(priorities, no priorities)
</li>
<li>Packet sizes
</li>
<li>Security(whether encrypted)
</li>
</ul>


<p>
IP is the "narrow waist" of the internet.
</p>
<p>
<img src="../resources/network/IPNarrowWaist.png" align="center" alt="../resources/network/IPNarrowWaist.png" />
</p>
<p class="verse">
The idea is make IP as a lowest common denominator.<br/>
Ask little from lower-layer, gives little to a higher-layer.<br/>
</p>


</div>

</div>

<div id="outline-container-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> IPv4</h4>
<div class="outline-text-4" id="text-4-2-2">


<p class="verse">
IPv4 carries 32-bit addresses on each packet(often 1.5KB)<br/>
<br/>
Uses datagrams, you can see Source and Destination addr inside.<br/>
</p>


<p>
The fields to handle the difference of networks:
</p>
<ul>
<li>Identification, Fragment offset, Fragment control bits for different packet size.

</li>
<li>Differentiated Services for QOS

</li>
<li>Time to live(TTL) for ICMP
</li>
</ul>


<p>
<img src="../resources/network/IPProtocol.png" align="center" alt="../resources/network/IPProtocol.png" />
</p>
<ul>
<li id="sec-4-2-2-1">IP Prefix<br/>
Notation: IP address/prefix-length E.g:128.13.0.0/16

</li>
</ul>
<ul>
<li id="sec-4-2-2-2">IP Allocation<br/>

<p>
<img src="../resources/network/IPAllocation.png" align="center" alt="../resources/network/IPAllocation.png" />
</p>
</li>
</ul>
</div>

</div>

<div id="outline-container-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> IP Forwarding</h4>
<div class="outline-text-4" id="text-4-2-3">

<p>Nodes uses a table that lists the next hop for IP prefixes. Example:
<img src="../resources/network/HopList.png" align="center" alt="../resources/network/HopList.png" />
</p>
<ul>
<li>Longest Matching Prefix

<p class="verse">
Prefixes can overlap!<br/>
In example above,<br/>
D: 192.24.0~63.0~255<br/>
B: 192.24.12~15.0~255<br/>
</p>


<p>
  <img src="../resources/network/IPOverlap.png" align="center" alt="../resources/network/IPOverlap.png" />
  The rule is to <b>more specific</b> area. This rule called <b>Longest Matching Prefix</b>.
</p>
<ul>
<li>Flexibility

<p class="verse">
provide default behavior, with less specific prefixes. <br/>
E.g. send traffic going outside an organization to a border router.<br/>
<br/>
special case behavior, with more specific prefixes.<br/>
E.g. For performance, economics, security<br/>
</p>


</li>
</ul>

</li>
</ul>



<ul>
<li>Host Forwarding Table
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Prefix</th><th scope="col" class="left">Next Hop</th></tr>
</thead>
<tbody>
<tr><td class="left">My network prefix</td><td class="left">Send direct to that IP</td></tr>
<tr><td class="left">0.0.0.0/0</td><td class="left">Send to my router</td></tr>
</tbody>
</table>

<ul>
<li>0.0.0.0/0 is a default route that catches all IP addresses.
</li>
</ul>

</li>
</ul>


</div>

</div>

<div id="outline-container-4-2-4" class="outline-4">
<h4 id="sec-4-2-4"><span class="section-number-4">4.2.4</span> Packet Size Issue</h4>
<div class="outline-text-4" id="text-4-2-4">


<p class="verse">
Different networks have different maximum packet sizes. <br/>
Also known MTU(Maximum Transmission Unit)<br/>
Two solutions:<br/>
</p>


<ul>
<li id="sec-4-2-4-1">Fragmentation<br/>
Split up large packets in the network-&mdash;classic method, dated.
<img src="../resources/network/PacketFragmentation.png" align="center" alt="../resources/network/PacketFragmentation.png" />



<p class="verse">
Related fields:<br/>
MF=More Fragment<br/>
DF=Don't Fragment<br/>
identification field links pieces together.<br/>
</p>


<p>
<img src="../resources/network/FragmentationFields.png" align="center" alt="../resources/network/FragmentationFields.png" />
</p>
<ul>
<li>Procedure

<ol>
<li>Copy IP header to pieces
</li>
<li>Adjust length on pieces
</li>
<li>Set offset to indicate position
</li>
<li>Set MF on all pieces except last
</li>
</ol>

</li>
</ul>



<p>
 <img src="../resources/network/FragmentationExample.png" align="center" alt="../resources/network/FragmentationExample.png" />
</p>
<ul>
<li>Disadvantages
<ul>
<li>More work for routers, hosts
</li>
<li>Tends to magnify loss rate
</li>
<li>Security vulnerabilities
</li>
</ul>

</li>
</ul>


</li>
</ul>
<ul>
<li id="sec-4-2-4-2">Discovery<br/>
Find the largest packet that fits on the network path.
<ul>
<li>Solution
  Host tests path with large packet.

<p>
  <img src="../resources/network/MTUDiscovery.png" align="center" alt="../resources/network/MTUDiscovery.png" />
</p>

<p class="verse">
Implemented with ICMP.<br/>
Set DF(Don't Fragment) bit in IP header to get feedback messages.<br/>
</p>


</li>
</ul>


</li>
</ul>
</div>

</div>

<div id="outline-container-4-2-5" class="outline-4">
<h4 id="sec-4-2-5"><span class="section-number-4">4.2.5</span> ICMP(Internet Control Message Protocol)</h4>
<div class="outline-text-4" id="text-4-2-5">


<p class="verse">
On IP Header: IP Protocol = 1<br/>
Provides error report and testing<br/>
<br/>
When router encounters an error while forwarding:<br/>
</p>


<ol>
<li>Sends an ICMP error report back to the IP source address
</li>
<li>Discards the problematic packet(host needs to rectify)
</li>
</ol>


<p>
<img src="../resources/network/RouterReturnICMPError.png" align="center" alt="../resources/network/RouterReturnICMPError.png" />
</p>
<ul>
<li>ICMP Message


<p class="verse">
ICMP message has a type, code, and checksum<br/>
Often carry the start of the offending packet as payload<br/>
Each message is carried in an IP packet<br/>
</p>



<p>  
  <img src="../resources/network/ICMPMessage.png" align="center" alt="../resources/network/ICMPMessage.png" />
</p>
<p>
  Some examples:
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Name</th><th scope="col" class="left">Type/Code</th><th scope="col" class="left">Usage</th></tr>
</thead>
<tbody>
<tr><td class="left">Dest. Unreachable(Net or Host)</td><td class="left">3/ 0or1</td><td class="left">Lack of connectivity</td></tr>
<tr><td class="left">Dest. Unreachable(Fragment)</td><td class="left">3/4</td><td class="left">Path MTU Discovery</td></tr>
<tr><td class="left">Time Exceeded(Transit)</td><td class="left">11/0</td><td class="left"><b>Traceroute</b></td></tr>
<tr><td class="left">Echo Request or Reply</td><td class="left">8or0 /0</td><td class="left">Ping</td></tr>
</tbody>
</table>


<p>  
  The last two are used for testing.
</p></li>
</ul>


</div>

</div>

<div id="outline-container-4-2-6" class="outline-4">
<h4 id="sec-4-2-6"><span class="section-number-4">4.2.6</span> IPv6</h4>
<div class="outline-text-4" id="text-4-2-6">

<ul>
<li>128 bits address

<p class="verse">
8 groups of 4 hex digits. Omit <b>leading</b> zeros and group of zeros.<br/>
Ex: 2001:0db8:0000:0000:0000:ff00:0042:8329<br/>
-&gt; 2001:db8:ff:42:8329<br/>
</p>


</li>
<li>Message Format

<p>
  <img src="../resources/network/IPv6Format.png" align="center" alt="../resources/network/IPv6Format.png" />
</p>
<p>
  The changes:
</p><ul>
<li>Streamlined header processing
</li>
<li>Flow lable to group of packets
</li>
<li>Better fit with advanced features(mobility, multicasting, security)

</li>
</ul>

</li>
<li>Deploy Issue

<p class="verse">
The format incompatible with IPv4<br/>
Solutions:<br/>
</p>


<ul>
<li>Dual stack (speak IPv4 and IPv6)
</li>
<li>Translators (convert packets)
</li>
<li>Tunnels (carry IPv6 on IPv4)

<p>    
    <img src="../resources/network/IPv6Tunneling.png" align="center" alt="../resources/network/IPv6Tunneling.png" />
</p></li>
</ul>

</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Traceroute</h3>
<div class="outline-text-3" id="text-4-3">

<p>Uses TTL(Time to live) field in IP header.
<img src="../resources/network/TimeToLiveField.png" align="center" alt="../resources/network/TimeToLiveField.png" />
</p>
<p class="verse">
TTL decremented every router hop, with ICMP error if it hits zero.<br/>
It also protects against forwarding loops.<br/>
<br/>
Traceroute sends probe packets increasing TTL starting from 1.<br/>
</p>


<p>
<img src="../resources/network/TraceRouterFlow.png" align="center" alt="../resources/network/TraceRouterFlow.png" />
</p>
</div>

</div>

<div id="outline-container-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> NAT(Network Address Translation)</h3>
<div class="outline-text-3" id="text-4-4">


<p class="verse">
NAT is one type of the <b>middle box</b>.<br/>
<b>Middle box</b> provides new functionality(NAT, firewall, Intrusion Detection).<br/>
NAT holds a table, map internal IP:Port with External IP:Port. <br/>
May look like the following table:<br/>
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="right" /><col class="right" />
</colgroup>
<thead>
<tr><th scope="col" class="right">Internal</th><th scope="col" class="right">External</th></tr>
</thead>
<tbody>
<tr><td class="right">192.168.1.12:5523</td><td class="right">44.25.80.3:1500</td></tr>
<tr><td class="right">192.168.1.13:1234</td><td class="right">44.25.80.3:1501</td></tr>
<tr><td class="right">192.168.2.20:1234</td><td class="right">44.25.80.3:1502</td></tr>
</tbody>
</table>



<p class="verse">
Internal&rarr; External: looks up the map, changes the src IP:Port.<br/>
External&rarr; Internal: changes the dest IP:Port.<br/>
</p>


<ul>
<li>Advantage
<ul>
<li>Relieves much public IP address pressure
</li>
<li>Easy to deploy
</li>
<li>Useful functionality(helps with privacy, firewall, etc.)
</li>
<li>

</li>
</ul>

</li>
<li>Disadvantage

<ul>
<li>Connectivity has been broken

<p class="verse">
Can only send packets after outgoing connection is set up.<br/>
Difficult to run servers or peer-to-peer apps(Skype) at home.<br/>
</p>



</li>
<li>Doesn't work so well with UDP
</li>
<li>Unwisely expose their IP addresses(FTP)?
</li>
</ul>

</li>
</ul>




</div>
</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Application Layer</h2>
<div class="outline-text-2" id="text-5">


</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> DHCP(Dynamic Host Configuration Protocol)</h3>
<div class="outline-text-3" id="text-5-1">

<p>Provide the following information to Node:
</p><ul>
<li>The node IP
</li>
<li>Network prefix
</li>
<li>Address of local router
</li>
<li>DNS server, time server, etc.
</li>
</ul>


<p>
DHCP uses UDP ports 67,68
</p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">DHCP</td></tr>
<tr><td class="left">UDP</td></tr>
<tr><td class="left">IP</td></tr>
<tr><td class="left">Ethernet</td></tr>
</tbody>
</table>



</div>

<div id="outline-container-5-1-1" class="outline-4">
<h4 id="sec-5-1-1"><span class="section-number-4">5.1.1</span> How does node find DHCP server?</h4>
<div class="outline-text-4" id="text-5-1-1">


<p class="verse">
Node sends broadcast messages.<br/>
broadcast address is all 1s.<br/>
255.255.255.255 for IP, ff:ff:ff:ff:ff:ff for Ethernet<br/>
</p>


<p>
<img src="../resources/network/DHCPSeq.png" align="center" alt="../resources/network/DHCPSeq.png" />
</p>
</div>
</div>
</div>
</div>
</div>

</body>
</html>

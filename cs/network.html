<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<!-- 2018-05-10 Thu 11:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Network</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="ChrisChen" />
<meta name="keywords" content="Network" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../styles/demo/css/demo.css"/>
<link href="https://fonts.proxy.ustclug.org/css?family=Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "left",
        displayIndent: "5em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "left",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Network</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org15e895d">1. Physical Layer</a>
<ul>
<li><a href="#org75a9383">1.1. Latency</a>
<ul>
<li><a href="#orgae92a8f">1.1.1. Transmission Delay</a></li>
<li><a href="#org735c9e9">1.1.2. Propagation Delay</a></li>
<li><a href="#org587381f">1.1.3. summary</a></li>
<li><a href="#org6c7aa5d">1.1.4. Bandwidth-Delay</a></li>
</ul>
</li>
<li><a href="#orgf108d42">1.2. Media</a>
<ul>
<li><a href="#org389fdc2">1.2.1. Wires</a></li>
<li><a href="#org47b351c">1.2.2. Fiber</a></li>
<li><a href="#org45c04cd">1.2.3. Wireless</a></li>
</ul>
</li>
<li><a href="#org82a8396">1.3. Signal</a>
<ul>
<li><a href="#org91fd828">1.3.1. Frequency Representation</a></li>
</ul>
</li>
<li><a href="#orgf7be967">1.4. Modulation</a>
<ul>
<li><a href="#orgc3230db">1.4.1. NRZ(Non-Return to Zero)</a></li>
<li><a href="#orge0146d0">1.4.2. Passband</a></li>
</ul>
</li>
<li><a href="#orgde7e7c6">1.5. Limit</a>
<ul>
<li><a href="#org52639a2">1.5.1. Nyquist Limit</a></li>
<li><a href="#org9cad6b6">1.5.2. Shannon Capacity</a></li>
</ul>
</li>
<li><a href="#orgf6e21ef">1.6. Other Hints</a>
<ul>
<li><a href="#org36148c9">1.6.1. Metric Units</a></li>
<li><a href="#orge2e8acc">1.6.2. BandWidth</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org81e7daa">2. Data Link Layer</a>
<ul>
<li><a href="#org62a5fa2">2.1. Frame</a>
<ul>
<li><a href="#orgb15db3b">2.1.1. PPP(Point-to-Point Protocol)</a></li>
<li><a href="#org206e2ad">2.1.2. CSMA/CD(Broadcast Protocol)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgffb7caf">3. Error Detection</a>
<ul>
<li><a href="#org3110055">3.1. Terms</a>
<ul>
<li><a href="#org768d39b">3.1.1. Codeword</a></li>
<li><a href="#org2bd9a0b">3.1.2. Hamming distance</a></li>
</ul>
</li>
<li><a href="#org99969d1">3.2. Parity Verification</a></li>
<li><a href="#org71bf333">3.3. Checksums</a>
<ul>
<li><a href="#orgc1adae2">3.3.1. Sending</a></li>
<li><a href="#org4c84993">3.3.2. Receiving</a></li>
<li><a href="#orgbe2f2ce">3.3.3. Conclusion</a></li>
</ul>
</li>
<li><a href="#orgc831213">3.4. CRC(Cyclic Redundancy Check)</a>
<ul>
<li><a href="#org7c02bdd">3.4.1. Sending</a></li>
<li><a href="#org3fe74cf">3.4.2. Receiving</a></li>
<li><a href="#org1b2d369">3.4.3. Conclusion</a></li>
</ul>
</li>
<li><a href="#org8d75a07">3.5. In Practice</a></li>
</ul>
</li>
<li><a href="#org12b98b1">4. Error Correction</a>
<ul>
<li><a href="#org6d436ac">4.1. Hamming Code</a>
<ul>
<li><a href="#org2829b62">4.1.1. Encoding</a></li>
<li><a href="#org4514f71">4.1.2. Decoding</a></li>
</ul>
</li>
<li><a href="#org0066847">4.2. Detection vs. Correction</a></li>
</ul>
</li>
<li><a href="#org4545352">5. Medium Access Control Sublayer</a>
<ul>
<li><a href="#org1d2ec53">5.1. Retransmissions</a>
<ul>
<li><a href="#org8ddb36e">5.1.1. Timeouts</a></li>
<li><a href="#orgad17f8c">5.1.2. Duplicates</a></li>
</ul>
</li>
<li><a href="#orgb6b347e">5.2. Multiplexing</a>
<ul>
<li><a href="#orgadd8a69">5.2.1. TDM/FDM Usage</a></li>
</ul>
</li>
<li><a href="#org8e6b65f">5.3. Multiple Access Control</a>
<ul>
<li><a href="#org8ac386c">5.3.1. Randomized Multiple Access</a></li>
<li><a href="#org98a0173">5.3.2. Wireless Multiple Access</a></li>
<li><a href="#org28a946c">5.3.3. Turn-Taking Multiple Access</a></li>
</ul>
</li>
<li><a href="#org437b1c2">5.4. Switching</a>
<ul>
<li><a href="#org37fe43d">5.4.1. Switch Forwarding</a></li>
<li><a href="#orgb0edaac">5.4.2. Switch Spanning Tree</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2776368">6. Network Layer</a>
<ul>
<li><a href="#org6e8cf2c">6.1. Service Models</a>
<ul>
<li><a href="#orgf701fdc">6.1.1. Store-and-Forward</a></li>
<li><a href="#orge62ce05">6.1.2. Datagrams(Connectionless)</a></li>
<li><a href="#org65737ed">6.1.3. Virtual Circuits(Connection-Oriented)</a></li>
<li><a href="#org569b5ca">6.1.4. Datagrams vs Virtual Circuits</a></li>
</ul>
</li>
<li><a href="#org55ddaca">6.2. IP(Internet Protocol)</a>
<ul>
<li><a href="#org7a76e8c">6.2.1. Internetworking</a></li>
<li><a href="#orgfa81cc7">6.2.2. IPv4</a></li>
<li><a href="#org623deb9">6.2.3. IP Forwarding</a></li>
<li><a href="#org7cebc73">6.2.4. Packet Size Issue</a></li>
<li><a href="#org12338a8">6.2.5. ICMP(Internet Control Message Protocol)</a></li>
<li><a href="#orgffd9665">6.2.6. IPv6</a></li>
</ul>
</li>
<li><a href="#org6a8621f">6.3. ARP(Address Resolution Protocol)</a></li>
<li><a href="#org47899ca">6.4. Traceroute</a></li>
<li><a href="#org2212430">6.5. NAT(Network Address Translation)</a></li>
</ul>
</li>
<li><a href="#orgba30b74">7. Routing</a>
<ul>
<li><a href="#org66e5337">7.1. Distance Vector Routing</a>
<ul>
<li><a href="#org1f77945">7.1.1. Dynamics</a></li>
<li><a href="#org7a14b0f">7.1.2. RIP(Routing Information Protocal)</a></li>
</ul>
</li>
<li><a href="#orgabd22df">7.2. Flooding</a>
<ul>
<li><a href="#org6a670b0">7.2.1. Rule Used at Each Node</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org290951e">8. Transport Layer</a>
<ul>
<li><a href="#org519d47b">8.1. TCP vs UDP</a></li>
<li><a href="#orgde7055e">8.2. Well-known Ports</a></li>
<li><a href="#orgdf0f940">8.3. UDP socket</a>
<ul>
<li><a href="#orgeb35b0d">8.3.1. header</a></li>
<li><a href="#orgecbf90e">8.3.2. sequence</a></li>
</ul>
</li>
<li><a href="#org7328037">8.4. TCP socket</a>
<ul>
<li><a href="#orgcbb53fe">8.4.1. Three-way handshake</a></li>
<li><a href="#orge1177a2">8.4.2. Connection Release</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7642a94">9. Application Layer</a>
<ul>
<li><a href="#org46a78f9">9.1. DHCP(Dynamic Host Configuration Protocol)</a>
<ul>
<li><a href="#orgc0d20df">9.1.1. How does node find DHCP server?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcf60a61">10. Devices</a>
<ul>
<li><a href="#org5651607">10.1. Hub</a></li>
<li><a href="#org103cf3e">10.2. Switch</a></li>
<li><a href="#orgc0bc244">10.3. Router</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org15e895d" class="outline-2">
<h2 id="org15e895d"><span class="section-number-2">1</span> Physical Layer</h2>
<div class="outline-text-2" id="text-1">
<p>
Concerns how signals are used to transfer message bits over a link.
</p>
</div>
<div id="outline-container-org75a9383" class="outline-3">
<h3 id="org75a9383"><span class="section-number-3">1.1</span> Latency</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Message Latency is the delay to send a message over a link.
</p>
</div>
<div id="outline-container-orgae92a8f" class="outline-4">
<h4 id="orgae92a8f"><span class="section-number-4">1.1.1</span> Transmission Delay</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Time to put M-bit message "on the wire"
\[T-delay = \frac{M(bits)}{Rate(bits/sec)} = \frac{M}{R}\ seconds\]
</p>
</div>
</div>

<div id="outline-container-org735c9e9" class="outline-4">
<h4 id="org735c9e9"><span class="section-number-4">1.1.2</span> Propagation Delay</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Time for bits to propagate across the wire
\[P-delay = \frac{Length}{speed\ of\ signals} \approx \frac{Length}{\frac{2}{3}C} = D\ seconds\]
C is the speed of light.
In copper wire, the speed s generally ranges from .59c to .77c
</p>
</div>
</div>

<div id="outline-container-org587381f" class="outline-4">
<h4 id="org587381f"><span class="section-number-4">1.1.3</span> summary</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
\[L = \frac{M}{R} + D\]
Often one delay component dominates.
</p>
</div>
</div>

<div id="outline-container-org6c7aa5d" class="outline-4">
<h4 id="org6c7aa5d"><span class="section-number-4">1.1.4</span> Bandwidth-Delay</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
BD is the maxmium amount of data in flight. Reperesents the data "in the network".
\[BD = R\times D\]
Small for LANs, big for "long fat" pipes(LFN "elephen").
</p>
<ul class="org-ul">
<li>An important example of a system where the bandwidth-delay product is large is that of geostationary satellite connections</li>
<li>TCP related option: TCP window scale option</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgf108d42" class="outline-3">
<h3 id="orgf108d42"><span class="section-number-3">1.2</span> Media</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Media propagate signals that carry bits of information
</p>
</div>
<div id="outline-container-org389fdc2" class="outline-4">
<h4 id="org389fdc2"><span class="section-number-4">1.2.1</span> Wires</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li><p>
Twisted Pair
</p>

<p>
Widely used in LANs and telephone lines. Twist reduce radiated signal.
</p></li>

<li>Coaxial Cable</li>
</ul>
</div>
</div>

<div id="outline-container-org47b351c" class="outline-4">
<h4 id="org47b351c"><span class="section-number-4">1.2.2</span> Fiber</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Long, thin, pure strands of glass. Properties: Enormous bandwidth
</p>
</div>
</div>

<div id="outline-container-org45c04cd" class="outline-4">
<h4 id="org45c04cd"><span class="section-number-4">1.2.3</span> Wireless</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
Sender radiates signal over a region. Properties:
</p>
<ul class="org-ul">
<li>In many directions, to potentially many receivers</li>
<li>Receiver need to coordinate use(choose a sender)</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org82a8396" class="outline-3">
<h3 id="org82a8396"><span class="section-number-3">1.3</span> Signal</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Analog signals encode digital bits.
</p>
</div>
<div id="outline-container-org91fd828" class="outline-4">
<h4 id="org91fd828"><span class="section-number-4">1.3.1</span> Frequency Representation</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
A signal over time can be represented by its frequency components.(Fourier analysis)
\[g(t)=\frac{1}{2}c+\sum_{n=1}^\infty a_n sin(2\pi nft) + \sum b_n cos(2\pi nft)\]
</p>
</div>
</div>
</div>
<div id="outline-container-orgf7be967" class="outline-3">
<h3 id="orgf7be967"><span class="section-number-3">1.4</span> Modulation</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-orgc3230db" class="outline-4">
<h4 id="orgc3230db"><span class="section-number-4">1.4.1</span> NRZ(Non-Return to Zero)</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Let a high voltage(+V) represent a 1, and low voltage(-V)represent a 0.
</p>
</div>
<ul class="org-ul">
<li><a id="org4ea2557"></a>4B/5B<br />
<div class="outline-text-5" id="text-org4ea2557">
<p>
Map every 4 bits into 5bits without long runs of zeros/ones.(called NRZI)
eg: 0000-&gt;11110, 0001-&gt;01001, 1110-&gt;11100, 1111-&gt;11101
Not work for fiber/wireless. Need to send at higher frequencies.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orge0146d0" class="outline-4">
<h4 id="orge0146d0"><span class="section-number-4">1.4.2</span> Passband</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Carriers is simply a signal oscillatiog at a desired frequency.
To modulate these signal, we can change amplitude, frequency, or phase.
</p>

<div class="figure">
<p><img src="../resources/network/SignalModulation.png" alt="SignalModulation.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Modulations</p>
</div>

<ul class="org-ul">
<li>more signal levels</li>
</ul>

<p>
eg: voltage splits into four levels. reperents 2bits per symbol.
</p>

<ul class="org-ul">
<li>Clock Recovery</li>
</ul>

<p>
Clock recovery is designed for the case like 1000000000&#x2026;0
</p>
</div>
</div>
</div>

<div id="outline-container-orgde7e7c6" class="outline-3">
<h3 id="orgde7e7c6"><span class="section-number-3">1.5</span> Limit</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org52639a2" class="outline-4">
<h4 id="org52639a2"><span class="section-number-4">1.5.1</span> Nyquist Limit</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
\[Maximum\ data\ rate = 2Hlog_{2}V\ bits/sec\]
</p>
<ul class="org-ul">
<li>V is the discrete levels the signal consists.</li>
<li>H is the bandwidth</li>
</ul>
</div>
</div>

<div id="outline-container-org9cad6b6" class="outline-4">
<h4 id="org9cad6b6"><span class="section-number-4">1.5.2</span> Shannon Capacity</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
\[Maximum\ data\ rate = Hlog_{2}(1+S/N)\ bits/sec\]
</p>
<ul class="org-ul">
<li>S/N is the signal-to-noise ratio, S is the signal power, N is the noise power.</li>
<li>S/N in db unit \(=10log_{10}(S/N)\)</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgf6e21ef" class="outline-3">
<h3 id="orgf6e21ef"><span class="section-number-3">1.6</span> Other Hints</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org36148c9" class="outline-4">
<h4 id="org36148c9"><span class="section-number-4">1.6.1</span> Metric Units</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Use power of 10 for rates, 2 for storage.
\[Mbps=1,000,000bps, 1KB = 2^{10}bytes\]
"B" is for bytes, "b" is for bits
</p>
</div>
</div>

<div id="outline-container-orge2e8acc" class="outline-4">
<h4 id="orge2e8acc"><span class="section-number-4">1.6.2</span> BandWidth</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
The range of frequencies transmitted without being strongly attenuated is called the bandwidth
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org81e7daa" class="outline-2">
<h2 id="org81e7daa"><span class="section-number-2">2</span> Data Link Layer</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org62a5fa2" class="outline-3">
<h3 id="org62a5fa2"><span class="section-number-3">2.1</span> Frame</h3>
<div class="outline-text-3" id="text-2-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">FLAG</td>
<td class="org-left">Header</td>
<td class="org-left">Payload field</td>
<td class="org-left">Trailer</td>
<td class="org-left">FLAG</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgb15db3b" class="outline-4">
<h4 id="orgb15db3b"><span class="section-number-4">2.1.1</span> PPP(Point-to-Point Protocol)</h4>
<div class="outline-text-4" id="text-2-1-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">FLAG(0x7E)</td>
<td class="org-left">Address(0xFF)</td>
<td class="org-left">Control(0x03)</td>
<td class="org-left">Protocol ID(2-byte)</td>
<td class="org-left">Payload</td>
<td class="org-left">Frame Check Sequence(3-byte)</td>
<td class="org-left">FLAG</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>MRU(maximum receive unit): 1500 bytes(Payload part)</li>
<li>ESC(escape character) is 0x7D</li>
</ul>
</div>
</div>

<div id="outline-container-org206e2ad" class="outline-4">
<h4 id="org206e2ad"><span class="section-number-4">2.1.2</span> CSMA/CD(Broadcast Protocol)</h4>
</div>
</div>
</div>

<div id="outline-container-orgffb7caf" class="outline-2">
<h2 id="orgffb7caf"><span class="section-number-2">3</span> Error Detection</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org3110055" class="outline-3">
<h3 id="org3110055"><span class="section-number-3">3.1</span> Terms</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org768d39b" class="outline-4">
<h4 id="org768d39b"><span class="section-number-4">3.1.1</span> Codeword</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
check bits of <b>n</b>-bit data is often referred to as an n-bit codeword.
</p>
</div>
</div>

<div id="outline-container-org2bd9a0b" class="outline-4">
<h4 id="org2bd9a0b"><span class="section-number-4">3.1.2</span> Hamming distance</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
The number of bit positions in which two codewords differ is called the Hamming distance.
eg: The hamming distance between 1011101 and 1001001 is 2
</p>

<ul class="org-ul">
<li>To detect <b>d</b> errors, we need <b>d+1</b> distance.</li>
<li>To correct <b>d</b> errors, we need <b>2d+1</b> distance.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org99969d1" class="outline-3">
<h3 id="org99969d1"><span class="section-number-3">3.2</span> Parity Verification</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li><p>
Simple Verification
</p>
<div class="org-src-container">
<pre class="src src-text">Take D data bits, add 1 check bit.
Check bit is the sum of the D bits module 2.(diff by even sum or odd)
Distance: 2
Detect 1 error
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org71bf333" class="outline-3">
<h3 id="org71bf333"><span class="section-number-3">3.3</span> Checksums</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-orgc1adae2" class="outline-4">
<h4 id="orgc1adae2"><span class="section-number-4">3.3.1</span> Sending</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
Sum is defined in 1s complement.
</p>
<ol class="org-ol">
<li>Arrange data in 16-bit words</li>
<li>Add all</li>
<li>Add with the carryover back to get 16bits</li>
<li>Trans to 1s Complement</li>
</ol>

<div class="org-src-container">
<pre class="src src-text">0001+f203+f4f5+f6f7=2ddf0
ddf0+2=ddf2
ddf2-&gt;220d
</pre>
</div>
</div>
</div>

<div id="outline-container-org4c84993" class="outline-4">
<h4 id="org4c84993"><span class="section-number-4">3.3.2</span> Receiving</h4>
<div class="outline-text-4" id="text-3-3-2">
<ol class="org-ol">
<li>Arrange data in 16-bit words</li>
<li>Add all + checksum</li>
<li>Add any carryover back to get 16bits.</li>
<li>Negate the result and check if it is 0.</li>
</ol>

<div class="org-src-container">
<pre class="src src-text">0001+f203+f4f5+f6f7+220d=2fffd
fffd+2 = ffff
ffff-&gt;0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbe2f2ce" class="outline-4">
<h4 id="orgbe2f2ce"><span class="section-number-4">3.3.3</span> Conclusion</h4>
<div class="outline-text-4" id="text-3-3-3">
<ul class="org-ul">
<li>Distance: 2</li>
<li>Detect 1 error</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc831213" class="outline-3">
<h3 id="orgc831213"><span class="section-number-3">3.4</span> CRC(Cyclic Redundancy Check)</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Given <b>n</b>-bit data, generate <b>k</b> check bits such that the <b>n+k</b> bits are evenly divisible by a generator C.
</p>
<ul class="org-ul">
<li>C(x) use the polynomial code. eg: 10011010 is \(x^7+x^4+x^3+x^1\)</li>
</ul>

<p>
Both the high- and low-order bits of the generator must be 1
</p>
</div>

<div id="outline-container-org7c02bdd" class="outline-4">
<h4 id="org7c02bdd"><span class="section-number-4">3.4.1</span> Sending</h4>
<div class="outline-text-4" id="text-3-4-1">
<ol class="org-ol">
<li>Extend the n data bits with <i>k</i> zeros</li>
<li>Divide by the generator value C</li>
<li>Keep remainder, ignore quotient</li>
<li>Adjust <i>k</i> check bits by remainder</li>
</ol>

<div class="org-src-container">
<pre class="src src-text">Frame: 1101011011
Generator: 10011
K: 4 bits
11010110110000 devided by 10011
Reminder: 0010
</pre>
</div>
</div>
</div>

<div id="outline-container-org3fe74cf" class="outline-4">
<h4 id="org3fe74cf"><span class="section-number-4">3.4.2</span> Receiving</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
Divide by the generator value C and check for zero remainder
</p>
</div>
</div>

<div id="outline-container-org1b2d369" class="outline-4">
<h4 id="org1b2d369"><span class="section-number-4">3.4.3</span> Conclusion</h4>
<div class="outline-text-4" id="text-3-4-3">
<p>
Protection depends on generator.
</p>

<p>
Standard CRC-32 is: 1111 0000 0100 1100 0001 0001 1101 1011 0111
</p>
<ul class="org-ul">
<li>Distance: 4</li>
<li>Detect 3 errors</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org8d75a07" class="outline-3">
<h3 id="org8d75a07"><span class="section-number-3">3.5</span> In Practice</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li>Parity is little used</li>
<li>Checksum used in Internet: IP, TCP, UDP</li>
<li>CRCs are widely used on links: Ethernet, 802.11, ADSL, Cable, etc.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org12b98b1" class="outline-2">
<h2 id="org12b98b1"><span class="section-number-2">4</span> Error Correction</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org6d436ac" class="outline-3">
<h3 id="org6d436ac"><span class="section-number-3">4.1</span> Hamming Code</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>Uses \(n=2^k-k-1\)</li>
<li>n: data bits</li>
<li>k: check bits</li>
</ul>

<p>
eg: n=4, k=3
</p>

<ol class="org-ol">
<li>Put check bits in positions p that are powers of 2, starting with position 1</li>
<li>Check bit in position <b>p</b> is parity of positions with a <b>p</b> term in their values</li>
</ol>


<div class="figure">
<p><img src="../resources/network/HammingCodeModel.png" alt="HammingCodeModel.png" />
</p>
</div>
</div>

<div id="outline-container-org2829b62" class="outline-4">
<h4 id="org2829b62"><span class="section-number-4">4.1.1</span> Encoding</h4>
<div class="outline-text-4" id="text-4-1-1">
<div class="org-src-container">
<pre class="src src-text">data=0101, 3 check bits
__0_101
P1=0+1+1=0
P2=0+0+1=1
P4=1+0+1=0
After encoded: 0100101
</pre>
</div>
</div>
</div>

<div id="outline-container-org4514f71" class="outline-4">
<h4 id="org4514f71"><span class="section-number-4">4.1.2</span> Decoding</h4>
<div class="outline-text-4" id="text-4-1-2">
<div class="org-src-container">
<pre class="src src-text">0100101
P1=P1+D3+D5+D7=0+0+1+1=0
P2=P2+D3+D6+D7=1+0+0+1=0
P4=P4+D5+D6+D7=0+1+0+1=0
Syndrome=000, no error

0100111
P1=0, P2=1, P4=1
Syndrome=110-&gt;6
The 6th bit is wrong.
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0066847" class="outline-3">
<h3 id="org0066847"><span class="section-number-3">4.2</span> Detection vs. Correction</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Error correction:
</p>
<ul class="org-ul">
<li>Needed when errors are expected</li>
<li>When no time for retransmission</li>
</ul>

<p>
Error dection:
</p>
<ul class="org-ul">
<li>More efficient when errors are not expected</li>
<li>When errors are large when they do occur</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4545352" class="outline-2">
<h2 id="org4545352"><span class="section-number-2">5</span> Medium Access Control Sublayer</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org1d2ec53" class="outline-3">
<h3 id="org1d2ec53"><span class="section-number-3">5.1</span> Retransmissions</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Detect errors and retransmit frame(Automatic Repeat reQuest, ARQ)
</p>
<ul class="org-ul">
<li>ARQ often used when errors are common or must be corrected. E.g., WIFI, TCP</li>
<li>Rules</li>
</ul>
<p class="verse">
Receiver automatically confirms with an ACK.<br />
Sender automatically resends after a timeout, until an ACK is received<br />
</p>
<p>
Two non-trivial issues: <b>Timeouts</b> and <b>Duplicates</b>
</p>
</div>
<div id="outline-container-org8ddb36e" class="outline-4">
<h4 id="org8ddb36e"><span class="section-number-4">5.1.1</span> Timeouts</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
Should be
</p>
<ul class="org-ul">
<li>Not too long (link goes idle)</li>
<li>Not too short (spurious resend)</li>
</ul>
</div>
</div>
<div id="outline-container-orgad17f8c" class="outline-4">
<h4 id="orgad17f8c"><span class="section-number-4">5.1.2</span> Duplicates</h4>
<div class="outline-text-4" id="text-5-1-2">
<p>
Two ways to solve this problem:
</p>
</div>
<ul class="org-ul">
<li><a id="orge53b700"></a>Stop-and-Wait<br />
<div class="outline-text-5" id="text-orge53b700">
<p>
Add a single bit to distinguish the current frame from the next one(in the head of the frame)
</p>
<ul class="org-ul">
<li><p>
Normal Case
</p>


<div class="figure">
<p><img src="../resources/network/SaWNormalCase.png" alt="SaWNormalCase.png" />
</p>
</div></li>
<li><p>
With Ack Loss
</p>


<div class="figure">
<p><img src="../resources/network/SaWWithACKLoss.png" alt="SaWWithACKLoss.png" />
</p>
</div></li>
<li><p>
With Early Timeout
</p>


<div class="figure">
<p><img src="../resources/network/SaWWithEarlyTimeout.png" alt="SaWWithEarlyTimeout.png" />
</p>
</div></li>

<li><p>
Limitation of Stop-and-Wait
</p>
<p class="verse">
Stop-and-Wait allows only one frame to<br />
be outstanding from the sender at a time.<br />
Not good with high BD networks.<br />
</p></li>
</ul>
</div>
</li>
<li><a id="org747292f"></a>Sliding Window<br />
<div class="outline-text-5" id="text-org747292f">
<p>
Generalization of Stop-and-Wait
</p>
<ul class="org-ul">
<li>Allow W frams to be outstanding</li>
<li>Can send W frams per RTT (= 2D + transmission time, Round Trip Time)</li>
<li>Various options for numbering frams/ACKs and handling loss</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgb6b347e" class="outline-3">
<h3 id="orgb6b347e"><span class="section-number-3">5.2</span> Multiplexing</h3>
<div class="outline-text-3" id="text-5-2">
<p>
<b>Multiplexing</b> is the network word for the sharing of a resource.
</p>
<ul class="org-ul">
<li><p>
Time Division Multiplexing (TDM)
</p>

<p>
Users take turns on a fixed schedule
</p></li>

<li><p>
Frequency Division Multiplexing (FDM)
</p>

<p>
Put different users on different frequency bands
</p></li>
</ul>
</div>
<div id="outline-container-orgadd8a69" class="outline-4">
<h4 id="orgadd8a69"><span class="section-number-4">5.2.1</span> TDM/FDM Usage</h4>
<div class="outline-text-4" id="text-5-2-1">
<ul class="org-ul">
<li><p>
Statically divide a resource
</p>
<p class="verse">
Suited for continuous traffic, fixed<br />
number of users<br />
</p></li>

<li><p>
Widely used in telecommunications
</p>
<p class="verse">
E.g:<br />
TV and radio stations: FDM<br />
GSM (2G cellular): TDM within FDM<br />
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org8e6b65f" class="outline-3">
<h3 id="org8e6b65f"><span class="section-number-3">5.3</span> Multiple Access Control</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-org8ac386c" class="outline-4">
<h4 id="org8ac386c"><span class="section-number-4">5.3.1</span> Randomized Multiple Access</h4>
<div class="outline-text-4" id="text-5-3-1">
</div>
<ul class="org-ul">
<li><a id="orgf206f17"></a>ALOHA<br />
<div class="outline-text-5" id="text-orgf206f17">
<p class="verse">
Simple idea:<br />
If there was a collision(no ACK received) then wait<br />
a random time and resend.<br />
</p>
<ul class="org-ul">
<li>Low load: Works well</li>
<li><p>
High load: Need improvement
</p>

<p>
Improvement: divide time into slots(transmit frames at the beginnings of slots)
</p></li>
</ul>
</div>
</li>

<li><a id="org3edf50e"></a>CSMA(Carrier Sense Multiple Access)<br />
<div class="outline-text-5" id="text-org3edf50e">
<ul class="org-ul">
<li><p>
<b>carrier sensing</b> (CSMA)
</p>

<p class="verse">
A node listens to the channel before transmitting.<br />
</p></li>

<li><p>
<b>collision detection</b> (CSMA/CD)
</p>

<p class="verse">
A transmitting node listens to the channel while it is transmitting.<br />
If it detects that another node is transmitting an interfering frame,<br />
it stops transmitting and wait a random amount time before repeating.<br />
</p>

<ul class="org-ul">
<li><p>
Complications
</p>

<p class="verse">
Time window in which a node may hear of a collision is 2D seconds.<br />
Solution: Impose a minimum frame size that last for 2D seconds.<br />
Then, node can't finish before collision.<br />
Note that: Ethernet minimum frame is 64bytes.<br />
</p></li>

<li><p>
Persistence
</p>

<p class="verse">
Multiple waiting nodes will queue up then collide.<br />
Espacially on high load network.<br />
<br />
Idea to solve: N queued senders, each send probability 1/N. How to estimate?<br />
<br />
In practice: BEB(Binary Exponential Backoff)<br />
Clever estimates the probability:<br />
1st collision, wait 0 to 1 frame times; 2nd, 0 to 3; 3rd, 0 to 7;<br />
BEB doubles interval for each successive collision.<br />
</p></li>

<li>Summary

<ul class="org-ul">
<li>CSMA Improve ALOHA by listening for activity before sending.</li>
<li>Can do easily with wire.</li>
<li>Still possible to hear nothing when another node is sending because of delay.</li>
<li>CSMA is a good defense against collisions only when BD is small</li>
</ul></li>
</ul></li>
</ul>
</div>
</li>

<li><a id="org26bdaf1"></a>Classic Ethernet<br />
<div class="outline-text-5" id="text-org26bdaf1">
<ul class="org-ul">
<li>10 Mbps over shared coaxial cable</li>
<li>1-persistent CSMA/CD with BEB</li>
<li><p>
Frame Format
</p>
<ul class="org-ul">
<li>contains addresses of sender and receiver</li>
<li>CRC-32 for error detection</li>
<li>No ACKs or retransmission</li>
<li>Start of frame identified with physical layer preamble</li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Preamble</td>
<td class="org-right">Dest addr</td>
<td class="org-right">Source addr</td>
<td class="org-right">Type</td>
<td class="org-right">Data(Packet from Network layer)</td>
<td class="org-right">Pad</td>
<td class="org-right">Check-sum</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">2</td>
<td class="org-right">0-1500</td>
<td class="org-right">0-46</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-org98a0173" class="outline-4">
<h4 id="org98a0173"><span class="section-number-4">5.3.2</span> Wireless Multiple Access</h4>
<div class="outline-text-4" id="text-5-3-2">
</div>
<ul class="org-ul">
<li><a id="orgc116e93"></a>Complications<br />
<div class="outline-text-5" id="text-orgc116e93">
<p>
Wireless can't work with CSMA/CD
</p>

<ul class="org-ul">
<li><p>
Nodes may have different areas of coverage
</p>

<p>
May case two problems:
</p>

<ul class="org-ul">
<li><p>
Hidden Terminals
</p>

<p>
A and C are hidden terminals when sending to B
</p>

<div class="figure">
<p><img src="../resources/network/HiddenTerminal.png" alt="HiddenTerminal.png" />
</p>
</div></li>

<li><p>
Exposed Terminals
</p>

<p>
B and C are exposed terminals when sending to A and D
</p>

<div class="figure">
<p><img src="../resources/network/ExposedTerminal.png" alt="ExposedTerminal.png" />
</p>
</div></li>
</ul></li>
</ul>


<ul class="org-ul">
<li><p>
Nodes can't hear while sending
</p>

<p>
Detecting collisions wasted much time with wireless.
</p></li>
</ul>
</div>
</li>
<li><a id="orge1cf782"></a>MACA Protocol<br />
<div class="outline-text-5" id="text-orge1cf782">
<p>
Uses a short handshake instead of CSMA
</p>

<ol class="org-ol">
<li>Sender transmits a RTS(Request-To-Send) with frame length</li>
<li>Receiver replies with a CTS(Clear-To-Send) with frame length</li>
<li>Sender transmits the frame while hearing the CTS <span class="underline">stay silent</span></li>
</ol>


<ul class="org-ul">
<li><p>
Solution For Hidden Terminals
</p>


<div class="figure">
<p><img src="../resources/network/MACAHiddenTerminal.png" alt="MACAHiddenTerminal.png" />
</p>
</div></li>

<li><p>
Solution For Exposed Terminals
</p>


<div class="figure">
<p><img src="../resources/network/MACAExposedTerminal.png" alt="MACAExposedTerminal.png" />
</p>
</div></li>

<li>Collisions on the RTS/CTS are still possible, but less likely</li>
</ul>
</div>
</li>
<li><a id="org7927105"></a>802.11<br />
<div class="outline-text-5" id="text-org7927105">
<ul class="org-ul">
<li>Physical Layer
<ul class="org-ul">
<li>Uses 20/40Mhz, b/g/n on 2.4GHz, a/n on 5GHz</li>
</ul></li>
<li><p>
Link Layer
</p>
<ul class="org-ul">
<li><p>
Multiple access uses CSMA/CA; RTS/CTS optional
</p>

<div class="figure">
<p><img src="../resources/network/CSMACASeq.png" alt="CSMACASeq.png" />
</p>
</div>

<p>
Backoff is a small random gap.
</p></li>

<li>Frames are ACKed and retransmitted with ARQ</li>
<li>Three addresses(due to AP)</li>
<li>Errors are detected with a 32-bit CRC</li>
</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Frame control</td>
<td class="org-right">Duration</td>
<td class="org-right">Dest addr</td>
<td class="org-right">Source addr</td>
<td class="org-right">AP addr</td>
<td class="org-right">Data</td>
<td class="org-right">Check-sum</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">0-2312</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org28a946c" class="outline-4">
<h4 id="org28a946c"><span class="section-number-4">5.3.3</span> Turn-Taking Multiple Access</h4>
<div class="outline-text-4" id="text-5-3-3">
<p>
Issue about CSMA under high load:
</p>
<ul class="org-ul">
<li>High overhead(expect collisions)</li>
<li>Access time varies(random)</li>
</ul>

<p class="verse">
Turn-Taking protocol defines an order in which nodes get a chance to send.<br />
The way to define ordering:<br />
E.g Token Ring, node addresses<br />
</p>

<ul class="org-ul">
<li><p>
Token Ring
</p>

<p>
Arrange nodes in a ring. Token rotates permission to send to each node in turn.
</p>

<div class="figure">
<p><img src="../resources/network/TokenRing.png" alt="TokenRing.png" />
</p>
</div></li>
</ul>


<ul class="org-ul">
<li>Advantages:

<ol class="org-ol">
<li>Fixed overhead with no collisions</li>
<li>Regular chance to send with no unlucky nodes</li>
</ol></li>

<li>DisAdvantages(Complexity):

<ol class="org-ol">
<li>More things could be wrong. E.g: token lost</li>
<li>High overhead at low load</li>
</ol></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org437b1c2" class="outline-3">
<h3 id="org437b1c2"><span class="section-number-3">5.4</span> Switching</h3>
<div class="outline-text-3" id="text-5-4">
<p class="verse">
Hub/repeater for physical layer.<br />
Router for network layer.<br />
Switch for link layer.<br />
</p>
<p>
Inside Switch Box:
</p>


<div class="figure">
<p><img src="../resources/network/InsideSwitch.png" alt="InsideSwitch.png" />
</p>
</div>

<p class="verse">
Uses buffers for multiple inputs to send to one output,<br />
may overload, and lead to frame loss.<br />
</p>


<div class="figure">
<p><img src="../resources/network/SwitchBuffer.png" alt="SwitchBuffer.png" />
</p>
</div>
</div>

<div id="outline-container-org37fe43d" class="outline-4">
<h4 id="org37fe43d"><span class="section-number-4">5.4.1</span> Switch Forwarding</h4>
<div class="outline-text-4" id="text-5-4-1">
<p>
Uses a learning table, sends to the port in the table or broadcasts to all ports.
</p>
</div>
</div>

<div id="outline-container-orgb0edaac" class="outline-4">
<h4 id="orgb0edaac"><span class="section-number-4">5.4.2</span> Switch Spanning Tree</h4>
<div class="outline-text-4" id="text-5-4-2">
<ul class="org-ul">
<li>How can we connect switches in any topology?</li>
<li><p>
Problem - forwarding loops
</p>


<div class="figure">
<p><img src="../resources/network/RedundantLinks.png" alt="RedundantLinks.png" />
</p>
</div>

<p>
Redundancy in case of failures. But loops occurs:
</p>

<ol class="org-ol">
<li>\(A\to C\to B, D-left, D-right\)</li>
<li>\(D-left\to C-right, E, F\)</li>
<li>\(D-right\to C-left, E, F\)</li>
<li>\(C-right\to D-left, A, B\)</li>
<li>\(C-left\to D-right, A, B\)</li>
<li>&#x2026;</li>
</ol></li>
</ul>
</div>

<ul class="org-ul">
<li><a id="org1fac939"></a>Solution<br />
<div class="outline-text-5" id="text-org1fac939">
<p>
Switches collectively find a spanning tree for the topology
</p>


<div class="figure">
<p><img src="../resources/network/STSolution1.png" alt="STSolution1.png" />
</p>
</div>

<ul class="org-ul">
<li>Outline

<ol class="org-ol">
<li>Elect a root node of the tree(switch with the lowest addr)</li>
<li>Grow tree as shortest distances from the root</li>
<li>Turn off ports for forwarding if they aren't on the spanning tree</li>
</ol></li>
</ul>


<ul class="org-ul">
<li><p>
Algorithm
</p>

<ol class="org-ol">
<li>Each switch initially believes it is the root of the tree</li>
<li>Each switch sends periodic updates to neighbors</li>
<li>Switches favors ports with shorter distances to lowest root</li>
</ol>

<p class="verse">
Update Information like:<br />
Hi, I'm <b>C</b>, the root is <b>A</b>, it's <b>2</b> hops away. (C, A, 2)<br />
</p></li>
</ul>


<ul class="org-ul">
<li>Example:
<ul class="org-ul">
<li><p>
At the beginning
</p>


<div class="figure">
<p><img src="../resources/network/STExample1.png" alt="STExample1.png" />
</p>
</div></li>

<li><p>
1st round, sending:
</p>

<p>
A sends (A,A,0) to say it is root. Same as B, C, D, E and F.
</p></li>

<li><p>
1st round, receiving:
</p>
<p class="verse">
A still thinks (A,A,0)<br />
B still thinks (B,B,0)<br />
C updates to (C,A,1)<br />
D updates to (D,C,1)<br />
E updates to (E,A,1)<br />
F updates to (F,B,1)<br />
</p>

<div class="figure">
<p><img src="../resources/network/STExample2.png" alt="STExample2.png" />
</p>
</div></li>

<li><p>
2nd round, receiving:
</p>
<p class="verse">
A still thinks (A,A,0)<br />
B updates to (B,A,2) via C<br />
C remains (C,A,1)<br />
D updates to (D,A,2) via C<br />
E remains (E,A,1)<br />
F remains (F,B,1)<br />
</p>

<div class="figure">
<p><img src="../resources/network/STExample3.png" alt="STExample3.png" />
</p>
</div></li>

<li><p>
3rd round, receiving:
</p>
<p class="verse">
A remains (A,A,0)<br />
B remains (B,A,2)<br />
C remains (C,A,1)<br />
D remains (D,A,2)<br />
E remains (E,A,1)<br />
F updates to (F,A,3) via B<br />
</p>

<div class="figure">
<p><img src="../resources/network/STExample4.png" alt="STExample4.png" />
</p>
</div></li>

<li><p>
4th round
</p>
<p class="verse">
Steady-state has be reached<br />
Turn off forwarding that is not on spanning tree<br />
</p></li>

<li><p>
Continus to run
</p>
<p class="verse">
Adapts by timeing out information<br />
E.g: If A fails, other nodes forget it, and B will become the new root<br />
</p></li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2776368" class="outline-2">
<h2 id="org2776368"><span class="section-number-2">6</span> Network Layer</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org6e8cf2c" class="outline-3">
<h3 id="org6e8cf2c"><span class="section-number-3">6.1</span> Service Models</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-orgf701fdc" class="outline-4">
<h4 id="orgf701fdc"><span class="section-number-4">6.1.1</span> Store-and-Forward</h4>
<div class="outline-text-4" id="text-6-1-1">
<p class="verse">
Both of two models use Store-and-Forward packet switching.<br />
Switching element has internal buffering for contention.<br />
</p>

<ul class="org-ul">
<li>Buffer is typically a FIFO queue</li>
<li>If full, packets will be discarded</li>
</ul>
</div>
</div>
<div id="outline-container-orge62ce05" class="outline-4">
<h4 id="orge62ce05"><span class="section-number-4">6.1.2</span> Datagrams(Connectionless)</h4>
<div class="outline-text-4" id="text-6-1-2">
<p>
Like postal letters
</p>
<ul class="org-ul">
<li>Packets contain a dest. address</li>
<li><p>
Each router has a forwarding table(often changes) keyed by dest addr.
Example table:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Router A's Table</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Dest.</th>
<th scope="col" class="org-left">Line</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">E</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-left">F</td>
<td class="org-left">C</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>

<div id="outline-container-org65737ed" class="outline-4">
<h4 id="org65737ed"><span class="section-number-4">6.1.3</span> Virtual Circuits(Connection-Oriented)</h4>
<div class="outline-text-4" id="text-6-1-3">
<p>
Like a telephone call. Three steps:
</p>
<ol class="org-ol">
<li>Connection establishment, circuit is set up (Path is chosen, circuit info stored in routers)</li>
<li>Data transfer, circuit is used</li>
<li>Connection teardown, circuit is deleted</li>
</ol>


<ul class="org-ul">
<li>Virtual means there's no bandwidth need be reserved</li>
<li>Packets only contain a short label to identify the circuit</li>
<li><p>
Each router has a forwarding table keyed by circuit
</p>

<div class="figure">
<p><img src="../resources/network/VirtualCircuitsTable.png" alt="VirtualCircuitsTable.png" />
</p>
</div></li>
</ul>
</div>


<ul class="org-ul">
<li><a id="orgac12f2b"></a>MPLS(Multi-Protocol Label Switching)<br />
<div class="outline-text-5" id="text-orgac12f2b">
<p>
A virtual-circuit like technology widely used by ISPs.
</p>

<ul class="org-ul">
<li>ISP set up circuits inside their backbone ahead of time</li>
<li><p>
ISP add MPLS label to IP packet at ingress, undoes at egress
</p>


<div class="figure">
<p><img src="../resources/network/MPLSStructure.png" alt="MPLSStructure.png" />
</p>
</div></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org569b5ca" class="outline-4">
<h4 id="org569b5ca"><span class="section-number-4">6.1.4</span> Datagrams vs Virtual Circuits</h4>
<div class="outline-text-4" id="text-6-1-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Issue</th>
<th scope="col" class="org-left">Datagrams</th>
<th scope="col" class="org-left">Vitual Circuits</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Setup</td>
<td class="org-left">Not needed</td>
<td class="org-left">Required</td>
</tr>

<tr>
<td class="org-left">Router state</td>
<td class="org-left">Per destination</td>
<td class="org-left">Per connection</td>
</tr>

<tr>
<td class="org-left">Addresses</td>
<td class="org-left">Packet carries full addr</td>
<td class="org-left">Packet carries short label</td>
</tr>

<tr>
<td class="org-left">Routing</td>
<td class="org-left">Per packet</td>
<td class="org-left">Per circuit</td>
</tr>

<tr>
<td class="org-left">Failures</td>
<td class="org-left">Easier to mask</td>
<td class="org-left">Hard to mask</td>
</tr>

<tr>
<td class="org-left">Quality of service</td>
<td class="org-left">Diffcult to add</td>
<td class="org-left">Easier to add</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org55ddaca" class="outline-3">
<h3 id="org55ddaca"><span class="section-number-3">6.2</span> IP(Internet Protocol)</h3>
<div class="outline-text-3" id="text-6-2">
</div>
<div id="outline-container-org7a76e8c" class="outline-4">
<h4 id="org7a76e8c"><span class="section-number-4">6.2.1</span> Internetworking</h4>
<div class="outline-text-4" id="text-6-2-1">
<p>
Connecting different networks together called internetworking. Differs:
</p>
<ul class="org-ul">
<li>Service model(datagrams, VCs)</li>
<li>Addressing</li>
<li>QOS(priorities, no priorities)</li>
<li>Packet sizes</li>
<li>Security(whether encrypted)</li>
</ul>

<p>
IP is the "narrow waist" of the internet.
</p>


<div class="figure">
<p><img src="../resources/network/IPNarrowWaist.png" alt="IPNarrowWaist.png" />
</p>
</div>
<p class="verse">
The idea is make IP as a lowest common denominator.<br />
Ask little from lower-layer, gives little to a higher-layer.<br />
</p>
</div>
</div>
<div id="outline-container-orgfa81cc7" class="outline-4">
<h4 id="orgfa81cc7"><span class="section-number-4">6.2.2</span> IPv4</h4>
<div class="outline-text-4" id="text-6-2-2">
<p class="verse">
IPv4 carries 32-bit addresses on each packet(often 1.5KB)<br />
<br />
Uses datagrams, you can see Source and Destination addr inside.<br />
</p>

<p>
The fields to handle the difference of networks:
</p>

<ul class="org-ul">
<li>Identification, Fragment offset, Fragment control bits for different packet size.</li>

<li>Differentiated Services for QOS</li>

<li>Time to live(TTL) for ICMP</li>
</ul>


<div class="figure">
<p><img src="../resources/network/IPProtocol.png" alt="IPProtocol.png" />
</p>
</div>
</div>

<ul class="org-ul">
<li><a id="org0e2c201"></a>IP Prefix<br />
<div class="outline-text-5" id="text-org0e2c201">
<p>
Notation: IP address/prefix-length E.g:128.13.0.0/16
</p>
</div>
</li>

<li><a id="org23fefc6"></a>IP Allocation<br />
<div class="outline-text-5" id="text-org23fefc6">

<div class="figure">
<p><img src="../resources/network/IPAllocation.png" alt="IPAllocation.png" />
</p>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org623deb9" class="outline-4">
<h4 id="org623deb9"><span class="section-number-4">6.2.3</span> IP Forwarding</h4>
<div class="outline-text-4" id="text-6-2-3">
<p>
Nodes uses a table that lists the next hop for IP prefixes. Example:
</p>

<div class="figure">
<p><img src="../resources/network/HopList.png" alt="HopList.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
Longest Matching Prefix
</p>
<p class="verse">
Prefixes can overlap!<br />
In example above,<br />
D: 192.24.0~63.0~255<br />
B: 192.24.12~15.0~255<br />
</p>

<div class="figure">
<p><img src="../resources/network/IPOverlap.png" alt="IPOverlap.png" />
</p>
</div></li>
</ul>


<p>
The rule is to <b>more specific</b> area. This rule called <b>Longest Matching Prefix</b>.
</p>

<ul class="org-ul">
<li><p>
Flexibility
</p>
<p class="verse">
provide default behavior, with less specific prefixes.<br />
E.g. send traffic going outside an organization to a border router.<br />
<br />
special case behavior, with more specific prefixes.<br />
E.g. For performance, economics, security<br />
</p></li>
</ul>


<ul class="org-ul">
<li><p>
Host Forwarding Table
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Prefix</th>
<th scope="col" class="org-left">Next Hop</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">My network prefix</td>
<td class="org-left">Send direct to that IP</td>
</tr>

<tr>
<td class="org-left">0.0.0.0/0</td>
<td class="org-left">Send to my router</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>0.0.0.0/0 is a default route that catches all IP addresses.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org7cebc73" class="outline-4">
<h4 id="org7cebc73"><span class="section-number-4">6.2.4</span> Packet Size Issue</h4>
<div class="outline-text-4" id="text-6-2-4">
<p class="verse">
Different networks have different maximum packet sizes.<br />
Also known MTU(Maximum Transmission Unit)<br />
Two solutions:<br />
</p>
</div>
<ul class="org-ul">
<li><a id="org2e35678"></a>Fragmentation<br />
<div class="outline-text-5" id="text-org2e35678">
<p>
Split up large packets in the network-&#x2014;classic method, dated.
</p>

<div class="figure">
<p><img src="../resources/network/PacketFragmentation.png" alt="PacketFragmentation.png" />
</p>
</div>


<p class="verse">
Related fields:<br />
MF=More Fragment<br />
DF=Don't Fragment<br />
identification field links pieces together.<br />
</p>


<div class="figure">
<p><img src="../resources/network/FragmentationFields.png" alt="FragmentationFields.png" />
</p>
</div>

<ul class="org-ul">
<li>Procedure

<ol class="org-ol">
<li>Copy IP header to pieces</li>
<li>Adjust length on pieces</li>
<li>Set offset to indicate position</li>
<li>Set MF on all pieces except last</li>
</ol></li>
</ul>



<div class="figure">
<p><img src="../resources/network/FragmentationExample.png" alt="FragmentationExample.png" />
</p>
</div>

<ul class="org-ul">
<li>Disadvantages
<ul class="org-ul">
<li>More work for routers, hosts</li>
<li>Tends to magnify loss rate</li>
<li>Security vulnerabilities</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="orgd23aa7e"></a>Discovery<br />
<div class="outline-text-5" id="text-orgd23aa7e">
<p>
Find the largest packet that fits on the network path.
</p>
<ul class="org-ul">
<li><p>
Solution
Host tests path with large packet.
</p>


<div class="figure">
<p><img src="../resources/network/MTUDiscovery.png" alt="MTUDiscovery.png" />
</p>
</div>

<p class="verse">
Implemented with ICMP.<br />
Set DF(Don't Fragment) bit in IP header to get feedback messages.<br />
</p></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org12338a8" class="outline-4">
<h4 id="org12338a8"><span class="section-number-4">6.2.5</span> ICMP(Internet Control Message Protocol)</h4>
<div class="outline-text-4" id="text-6-2-5">
<p class="verse">
On IP Header: IP Protocol = 1<br />
Provides error report and testing<br />
<br />
When router encounters an error while forwarding:<br />
</p>
<ol class="org-ol">
<li>Sends an ICMP error report back to the IP source address</li>
<li>Discards the problematic packet(host needs to rectify)</li>
</ol>


<div class="figure">
<p><img src="../resources/network/RouterReturnICMPError.png" alt="RouterReturnICMPError.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
ICMP Message
</p>

<p class="verse">
ICMP message has a type, code, and checksum<br />
Often carry the start of the offending packet as payload<br />
Each message is carried in an IP packet<br />
</p>


<div class="figure">
<p><img src="../resources/network/ICMPMessage.png" alt="ICMPMessage.png" />
</p>
</div>

<p>
Some examples:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-left">Type/Code</th>
<th scope="col" class="org-left">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Dest. Unreachable(Net or Host)</td>
<td class="org-left">3/ 0or1</td>
<td class="org-left">Lack of connectivity</td>
</tr>

<tr>
<td class="org-left">Dest. Unreachable(Fragment)</td>
<td class="org-left">3/4</td>
<td class="org-left">Path MTU Discovery</td>
</tr>

<tr>
<td class="org-left">Time Exceeded(Transit)</td>
<td class="org-left">11/0</td>
<td class="org-left"><b>Traceroute</b></td>
</tr>

<tr>
<td class="org-left">Echo Request or Reply</td>
<td class="org-left">8or0 /0</td>
<td class="org-left">Ping</td>
</tr>
</tbody>
</table>

<p>
The last two are used for testing.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgffd9665" class="outline-4">
<h4 id="orgffd9665"><span class="section-number-4">6.2.6</span> IPv6</h4>
<div class="outline-text-4" id="text-6-2-6">
<ul class="org-ul">
<li><p>
128 bits address
</p>
<p class="verse">
8 groups of 4 hex digits. Omit <b>leading</b> zeros and group of zeros.<br />
Ex: 2001:0db8:0000:0000:0000:ff00:0042:8329<br />
-&gt; 2001:db8:ff:42:8329<br />
</p></li>

<li><p>
Message Format
</p>


<div class="figure">
<p><img src="../resources/network/IPv6Format.png" alt="IPv6Format.png" />
</p>
</div>

<p>
The changes:
</p>
<ul class="org-ul">
<li>Streamlined header processing</li>
<li>Flow lable to group of packets</li>
<li>Better fit with advanced features(mobility, multicasting, security)</li>
</ul></li>

<li><p>
Deploy Issue
</p>
<p class="verse">
The format incompatible with IPv4<br />
Solutions:<br />
</p>
<ul class="org-ul">
<li>Dual stack (speak IPv4 and IPv6)</li>
<li>Translators (convert packets)</li>
<li><p>
Tunnels (carry IPv6 on IPv4)
</p>


<div class="figure">
<p><img src="../resources/network/IPv6Tunneling.png" alt="IPv6Tunneling.png" />
</p>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org6a8621f" class="outline-3">
<h3 id="org6a8621f"><span class="section-number-3">6.3</span> ARP(Address Resolution Protocol)</h3>
<div class="outline-text-3" id="text-6-3">
<p>
Node uses ARP to map a local IP address to its Link layer address
</p>

<div class="figure">
<p><img src="../resources/network/ARPPurpose.png" alt="ARPPurpose.png" />
</p>
</div>

<ul class="org-ul">
<li>No servers, just asks node with target IP.</li>
<li>Uses <b>broadcast</b> to reach all nodes.</li>
</ul>


<div class="figure">
<p><img src="../resources/network/ARPSeq.png" alt="ARPSeq.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org47899ca" class="outline-3">
<h3 id="org47899ca"><span class="section-number-3">6.4</span> Traceroute</h3>
<div class="outline-text-3" id="text-6-4">
<p>
Uses TTL(Time to live) field in IP header.
</p>

<div class="figure">
<p><img src="../resources/network/TimeToLiveField.png" alt="TimeToLiveField.png" />
</p>
</div>
<p class="verse">
TTL decremented every router hop, with ICMP error if it hits zero.<br />
It also protects against forwarding loops.<br />
<br />
Traceroute sends probe packets increasing TTL starting from 1.<br />
</p>


<div class="figure">
<p><img src="../resources/network/TraceRouterFlow.png" alt="TraceRouterFlow.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org2212430" class="outline-3">
<h3 id="org2212430"><span class="section-number-3">6.5</span> NAT(Network Address Translation)</h3>
<div class="outline-text-3" id="text-6-5">
<p class="verse">
NAT is one type of the <b>middle box</b>.<br />
<b>Middle box</b> provides new functionality(NAT, firewall, Intrusion Detection).<br />
NAT holds a table, map internal IP:Port with External IP:Port.<br />
May look like the following table:<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Internal</th>
<th scope="col" class="org-right">External</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">192.168.1.12:5523</td>
<td class="org-right">44.25.80.3:1500</td>
</tr>

<tr>
<td class="org-right">192.168.1.13:1234</td>
<td class="org-right">44.25.80.3:1501</td>
</tr>

<tr>
<td class="org-right">192.168.2.20:1234</td>
<td class="org-right">44.25.80.3:1502</td>
</tr>
</tbody>
</table>

<p class="verse">
Internal&rarr; External: looks up the map, changes the src IP:Port.<br />
External&rarr; Internal: changes the dest IP:Port.<br />
</p>

<ul class="org-ul">
<li>Advantage
<ul class="org-ul">
<li>Relieves much public IP address pressure</li>
<li>Easy to deploy</li>
<li>Useful functionality(helps with privacy, firewall, etc.)</li>
</ul></li>

<li>Disadvantage

<ul class="org-ul">
<li><p>
Connectivity has been broken
</p>
<p class="verse">
Can only send packets after outgoing connection is set up.<br />
Difficult to run servers or peer-to-peer apps(Skype) at home.<br />
</p></li>

<li>Doesn't work so well with UDP</li>
<li>Unwisely expose their IP addresses(FTP)?</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgba30b74" class="outline-2">
<h2 id="orgba30b74"><span class="section-number-2">7</span> Routing</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org66e5337" class="outline-3">
<h3 id="org66e5337"><span class="section-number-3">7.1</span> Distance Vector Routing</h3>
<div class="outline-text-3" id="text-7-1">

<div class="figure">
<p><img src="../resources/network/DVExample.png" alt="DVExample.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
Initial Status
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">To</th>
<th scope="col" class="org-left">A</th>
<th scope="col" class="org-left">B</th>
<th scope="col" class="org-left">C</th>
<th scope="col" class="org-left">D</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-left">0</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">0</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">0</td>
<td class="org-left">\(\infty\)</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">\(\infty\)</td>
<td class="org-left">0</td>
</tr>
</tbody>
</table></li>

<li><p>
1st Exchange
</p>
<p class="verse">
AC: A Cost<br />
AN: A NextTo<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">To</th>
<th scope="col" class="org-right">AC</th>
<th scope="col" class="org-left">AN</th>
<th scope="col" class="org-right">BC</th>
<th scope="col" class="org-left">BN</th>
<th scope="col" class="org-right">CC</th>
<th scope="col" class="org-left">CN</th>
<th scope="col" class="org-right">DC</th>
<th scope="col" class="org-left">DN</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">3</td>
<td class="org-left">A</td>
<td class="org-right">\(\infty\)</td>
<td class="org-left">--</td>
<td class="org-right">7</td>
<td class="org-left">A</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">6</td>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-right">\(\infty\)</td>
<td class="org-left">--</td>
<td class="org-right">6</td>
<td class="org-left">C</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">2</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-right">7</td>
<td class="org-left">D</td>
<td class="org-right">3</td>
<td class="org-left">D</td>
<td class="org-right">2</td>
<td class="org-left">D</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
</tr>
</tbody>
</table></li>

<li><p>
2nd Exchange
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">To</th>
<th scope="col" class="org-right">AC</th>
<th scope="col" class="org-left">AN</th>
<th scope="col" class="org-right">BC</th>
<th scope="col" class="org-left">BN</th>
<th scope="col" class="org-right">CC</th>
<th scope="col" class="org-left">CN</th>
<th scope="col" class="org-right">DC</th>
<th scope="col" class="org-left">DN</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">3</td>
<td class="org-left">A</td>
<td class="org-right">9</td>
<td class="org-left">B</td>
<td class="org-right">6</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">5</td>
<td class="org-left">D</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-right">9</td>
<td class="org-left">D</td>
<td class="org-right">5</td>
<td class="org-left">D</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">2</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-right">6</td>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">D</td>
<td class="org-right">2</td>
<td class="org-left">D</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
</tr>
</tbody>
</table></li>

<li><p>
final
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">To</th>
<th scope="col" class="org-right">AC</th>
<th scope="col" class="org-left">AN</th>
<th scope="col" class="org-right">BC</th>
<th scope="col" class="org-left">BN</th>
<th scope="col" class="org-right">CC</th>
<th scope="col" class="org-left">CN</th>
<th scope="col" class="org-right">DC</th>
<th scope="col" class="org-left">DN</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">3</td>
<td class="org-left">A</td>
<td class="org-right">8</td>
<td class="org-left">D</td>
<td class="org-right">6</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">5</td>
<td class="org-left">D</td>
<td class="org-right">3</td>
<td class="org-left">B</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-right">8</td>
<td class="org-left">B</td>
<td class="org-right">5</td>
<td class="org-left">D</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
<td class="org-right">2</td>
<td class="org-left">C</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-right">6</td>
<td class="org-left">B</td>
<td class="org-right">3</td>
<td class="org-left">D</td>
<td class="org-right">2</td>
<td class="org-left">D</td>
<td class="org-right">0</td>
<td class="org-left">--</td>
</tr>
</tbody>
</table></li>
</ul>
</div>

<div id="outline-container-org1f77945" class="outline-4">
<h4 id="org1f77945"><span class="section-number-4">7.1.1</span> Dynamics</h4>
<div class="outline-text-4" id="text-7-1-1">
<ul class="org-ul">
<li>Adding routes: one hop per exchange</li>
<li>Removing routes: no more exchanges</li>
<li><p>
Partitions are a problem: "Count to infinity" scenario
</p>


<div class="figure">
<p><img src="../resources/network/CountToInfty.png" alt="CountToInfty.png" />
</p>
</div>

<p class="verse">
Some way to address: Split horizon, poison reverse.<br />
(Don't send route back to where you learned it from)<br />
<br />
There's no very effective way to solve this problem.<br />
And now link state favored in practice.<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org7a14b0f" class="outline-4">
<h4 id="org7a14b0f"><span class="section-number-4">7.1.2</span> RIP(Routing Information Protocal)</h4>
<div class="outline-text-4" id="text-7-1-2">
<ul class="org-ul">
<li>DV protocal with hop count as metric
<ul class="org-ul">
<li>Infinity is 16 hops; limits network size.</li>
<li>Include split horizon, poison reverse.</li>
</ul></li>

<li>Routers send vectors every 30 secs
<ul class="org-ul">
<li>Runs on top of UDP.</li>
<li>Timeout in 180 secs to detect failures.</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgabd22df" class="outline-3">
<h3 id="orgabd22df"><span class="section-number-3">7.2</span> Flooding</h3>
<div class="outline-text-3" id="text-7-2">
</div>
<div id="outline-container-org6a670b0" class="outline-4">
<h4 id="org6a670b0"><span class="section-number-4">7.2.1</span> Rule Used at Each Node</h4>
<div class="outline-text-4" id="text-7-2-1">
<ul class="org-ul">
<li>Sends an incoming message on to all other neighbors</li>
<li><p>
Remember the message so that it is only flood once
</p>

<p>
Using source and sequence number
</p></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org290951e" class="outline-2">
<h2 id="org290951e"><span class="section-number-2">8</span> Transport Layer</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org519d47b" class="outline-3">
<h3 id="org519d47b"><span class="section-number-3">8.1</span> TCP vs UDP</h3>
<div class="outline-text-3" id="text-8-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">TCP(Streams)</th>
<th scope="col" class="org-left">UDP(Datagrams)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Connections</td>
<td class="org-left">Datagrams</td>
</tr>

<tr>
<td class="org-left">Reliably, and in order</td>
<td class="org-left">reordered, duplicated, msg may be lost</td>
</tr>

<tr>
<td class="org-left">Arbitrary length content</td>
<td class="org-left">Limited message size</td>
</tr>

<tr>
<td class="org-left">Flow control</td>
<td class="org-left">Can send regardless of receiver state</td>
</tr>

<tr>
<td class="org-left">Congestion control</td>
<td class="org-left">Can send regardless of network state</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgde7055e" class="outline-3">
<h3 id="orgde7055e"><span class="section-number-3">8.2</span> Well-known Ports</h3>
<div class="outline-text-3" id="text-8-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Port</td>
<td class="org-left">Protocol</td>
<td class="org-left">Use</td>
</tr>

<tr>
<td class="org-right">20, 21</td>
<td class="org-left">FTP</td>
<td class="org-left">File transfer</td>
</tr>

<tr>
<td class="org-right">22</td>
<td class="org-left">SSH</td>
<td class="org-left">Remote login</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-left">SMTP</td>
<td class="org-left">Email</td>
</tr>

<tr>
<td class="org-right">80</td>
<td class="org-left">HTTP</td>
<td class="org-left">World Wide Web</td>
</tr>

<tr>
<td class="org-right">110</td>
<td class="org-left">POP-3</td>
<td class="org-left">Remote email access</td>
</tr>

<tr>
<td class="org-right">143</td>
<td class="org-left">IMAP</td>
<td class="org-left">Remote email access</td>
</tr>

<tr>
<td class="org-right">443</td>
<td class="org-left">HTTPS</td>
<td class="org-left">Secure Web (HTTP over SSL/TLS)</td>
</tr>

<tr>
<td class="org-right">543</td>
<td class="org-left">RTSP</td>
<td class="org-left">Media player control</td>
</tr>

<tr>
<td class="org-right">631</td>
<td class="org-left">IPP</td>
<td class="org-left">Printer sharing</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgdf0f940" class="outline-3">
<h3 id="orgdf0f940"><span class="section-number-3">8.3</span> UDP socket</h3>
<div class="outline-text-3" id="text-8-3">
</div>
<div id="outline-container-orgeb35b0d" class="outline-4">
<h4 id="orgeb35b0d"><span class="section-number-4">8.3.1</span> header</h4>
<div class="outline-text-4" id="text-8-3-1">
<ul class="org-ul">
<li>Datagram length up to 64K</li>
<li>Checksum(16 bits) for reliability</li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Source port</td>
<td class="org-left">Destination</td>
</tr>

<tr>
<td class="org-left">UDP length</td>
<td class="org-left">UDP checksum</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgecbf90e" class="outline-4">
<h4 id="orgecbf90e"><span class="section-number-4">8.3.2</span> sequence</h4>
<div class="outline-text-4" id="text-8-3-2">

<div class="figure">
<p><img src="../resources/network/DatagramSockets.png" alt="DatagramSockets.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7328037" class="outline-3">
<h3 id="org7328037"><span class="section-number-3">8.4</span> TCP socket</h3>
<div class="outline-text-3" id="text-8-4">
</div>
<div id="outline-container-orgcbb53fe" class="outline-4">
<h4 id="orgcbb53fe"><span class="section-number-4">8.4.1</span> Three-way handshake</h4>
<div class="outline-text-4" id="text-8-4-1">

<div class="figure">
<p><img src="../resources/network/ThreeWayHandshake.png" alt="ThreeWayHandshake.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
state machine
</p>


<div class="figure">
<p><img src="../resources/network/ThreeWayHandshake_SM.png" alt="ThreeWayHandshake_SM.png" />
</p>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-orge1177a2" class="outline-4">
<h4 id="orge1177a2"><span class="section-number-4">8.4.2</span> Connection Release</h4>
<div class="outline-text-4" id="text-8-4-2">

<div class="figure">
<p><img src="../resources/network/TCPConnectionRelease.png" alt="TCPConnectionRelease.png" />
</p>
</div>

<ul class="org-ul">
<li><p>
state machine
</p>


<div class="figure">
<p><img src="../resources/network/TCPConnectionRelease_SM.png" alt="TCPConnectionRelease_SM.png" />
</p>
</div></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org7642a94" class="outline-2">
<h2 id="org7642a94"><span class="section-number-2">9</span> Application Layer</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org46a78f9" class="outline-3">
<h3 id="org46a78f9"><span class="section-number-3">9.1</span> DHCP(Dynamic Host Configuration Protocol)</h3>
<div class="outline-text-3" id="text-9-1">
<p>
Provide the following information to Node:
</p>
<ul class="org-ul">
<li>The node IP</li>
<li>Network prefix</li>
<li>Address of local router</li>
<li>DNS server, time server, etc.</li>
</ul>

<p>
DHCP uses UDP ports 67,68
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">DHCP</td>
</tr>

<tr>
<td class="org-left">UDP</td>
</tr>

<tr>
<td class="org-left">IP</td>
</tr>

<tr>
<td class="org-left">Ethernet</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgc0d20df" class="outline-4">
<h4 id="orgc0d20df"><span class="section-number-4">9.1.1</span> How does node find DHCP server?</h4>
<div class="outline-text-4" id="text-9-1-1">
<p class="verse">
Node sends broadcast messages.<br />
broadcast address is all 1s.<br />
255.255.255.255 for IP, ff:ff:ff:ff:ff:ff for Ethernet<br />
</p>

<div class="figure">
<p><img src="../resources/network/DHCPSeq.png" alt="DHCPSeq.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcf60a61" class="outline-2">
<h2 id="orgcf60a61"><span class="section-number-2">10</span> Devices</h2>
<div class="outline-text-2" id="text-10">

<div class="figure">
<p><img src="../resources/network/osi.png" alt="osi.png" />
</p>
</div>
</div>
<div id="outline-container-org5651607" class="outline-3">
<h3 id="org5651607"><span class="section-number-3">10.1</span> Hub</h3>
<div class="outline-text-3" id="text-10-1">
<ul class="org-ul">
<li>on physical layer. broadcast forwarding</li>
</ul>
</div>
</div>

<div id="outline-container-org103cf3e" class="outline-3">
<h3 id="org103cf3e"><span class="section-number-3">10.2</span> Switch</h3>
<div class="outline-text-3" id="text-10-2">
<ul class="org-ul">
<li>on link layer. use MAC address.</li>
</ul>
</div>
</div>

<div id="outline-container-orgc0bc244" class="outline-3">
<h3 id="orgc0bc244"><span class="section-number-3">10.3</span> Router</h3>
<div class="outline-text-3" id="text-10-3">
<ul class="org-ul">
<li>on network layer. use IP.</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
